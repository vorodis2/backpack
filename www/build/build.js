!function(e){var t=window.webpackHotUpdate;window.webpackHotUpdate=function(e,i){!function(e,t){if(!I[e]||!v[e])return;for(var i in v[e]=!1,t)Object.prototype.hasOwnProperty.call(t,i)&&(g[i]=t[i]);0==--m&&0===x&&T()}(e,i),t&&t(e,i)};var i,A=!0,a="484daeef25161872b98b",n=1e4,r={},s=[],o=[];function h(e){var t=w[e];if(!t)return F;var A=function(A){return t.hot.active?(w[A]?-1===w[A].parents.indexOf(e)&&w[A].parents.push(e):(s=[e],i=A),-1===t.children.indexOf(A)&&t.children.push(A)):(console.warn("[HMR] unexpected require("+A+") from disposed module "+e),s=[]),F(A)},a=function(e){return{configurable:!0,enumerable:!0,get:function(){return F[e]},set:function(t){F[e]=t}}};for(var n in F)Object.prototype.hasOwnProperty.call(F,n)&&"e"!==n&&"t"!==n&&Object.defineProperty(A,n,a(n));return A.e=function(e){return"ready"===u&&c("prepare"),x++,F.e(e).then(t,function(e){throw t(),e});function t(){x--,"prepare"===u&&(E[e]||b(e),0===x&&0===m&&T())}},A.t=function(e,t){return 1&t&&(e=A(e)),F.t(e,-2&t)},A}function l(e){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:i!==e,active:!0,accept:function(e,i){if(void 0===e)t._selfAccepted=!0;else if("function"==typeof e)t._selfAccepted=e;else if("object"==typeof e)for(var A=0;A<e.length;A++)t._acceptedDependencies[e[A]]=i||function(){};else t._acceptedDependencies[e]=i||function(){}},decline:function(e){if(void 0===e)t._selfDeclined=!0;else if("object"==typeof e)for(var i=0;i<e.length;i++)t._declinedDependencies[e[i]]=!0;else t._declinedDependencies[e]=!0},dispose:function(e){t._disposeHandlers.push(e)},addDisposeHandler:function(e){t._disposeHandlers.push(e)},removeDisposeHandler:function(e){var i=t._disposeHandlers.indexOf(e);i>=0&&t._disposeHandlers.splice(i,1)},check:y,apply:_,status:function(e){if(!e)return u;d.push(e)},addStatusHandler:function(e){d.push(e)},removeStatusHandler:function(e){var t=d.indexOf(e);t>=0&&d.splice(t,1)},data:r[e]};return i=void 0,t}var d=[],u="idle";function c(e){u=e;for(var t=0;t<d.length;t++)d[t].call(null,e)}var f,g,p,m=0,x=0,E={},v={},I={};function C(e){return+e+""===e?+e:e}function y(e){if("idle"!==u)throw new Error("check() is only allowed in idle status");return A=e,c("check"),(t=n,t=t||1e4,new Promise(function(e,i){if("undefined"==typeof XMLHttpRequest)return i(new Error("No browser support"));try{var A=new XMLHttpRequest,n=F.p+""+a+".hot-update.json";A.open("GET",n,!0),A.timeout=t,A.send(null)}catch(e){return i(e)}A.onreadystatechange=function(){if(4===A.readyState)if(0===A.status)i(new Error("Manifest request to "+n+" timed out."));else if(404===A.status)e();else if(200!==A.status&&304!==A.status)i(new Error("Manifest request to "+n+" failed."));else{try{var t=JSON.parse(A.responseText)}catch(e){return void i(e)}e(t)}}})).then(function(e){if(!e)return c("idle"),null;v={},E={},I=e.c,p=e.h,c("prepare");var t=new Promise(function(e,t){f={resolve:e,reject:t}});g={};return b(0),"prepare"===u&&0===x&&0===m&&T(),t});var t}function b(e){I[e]?(v[e]=!0,m++,function(e){var t=document.createElement("script");t.charset="utf-8",t.src=F.p+""+e+"."+a+".hot-update.js",document.head.appendChild(t)}(e)):E[e]=!0}function T(){c("ready");var e=f;if(f=null,e)if(A)Promise.resolve().then(function(){return _(A)}).then(function(t){e.resolve(t)},function(t){e.reject(t)});else{var t=[];for(var i in g)Object.prototype.hasOwnProperty.call(g,i)&&t.push(C(i));e.resolve(t)}}function _(t){if("ready"!==u)throw new Error("apply() is only allowed in ready status");var i,A,n,o,h;function l(e){for(var t=[e],i={},A=t.slice().map(function(e){return{chain:[e],id:e}});A.length>0;){var a=A.pop(),n=a.id,r=a.chain;if((o=w[n])&&!o.hot._selfAccepted){if(o.hot._selfDeclined)return{type:"self-declined",chain:r,moduleId:n};if(o.hot._main)return{type:"unaccepted",chain:r,moduleId:n};for(var s=0;s<o.parents.length;s++){var h=o.parents[s],l=w[h];if(l){if(l.hot._declinedDependencies[n])return{type:"declined",chain:r.concat([h]),moduleId:n,parentId:h};-1===t.indexOf(h)&&(l.hot._acceptedDependencies[n]?(i[h]||(i[h]=[]),d(i[h],[n])):(delete i[h],t.push(h),A.push({chain:r.concat([h]),id:h})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:i}}function d(e,t){for(var i=0;i<t.length;i++){var A=t[i];-1===e.indexOf(A)&&e.push(A)}}t=t||{};var f={},m=[],x={},E=function(){console.warn("[HMR] unexpected require("+y.moduleId+") to disposed module")};for(var v in g)if(Object.prototype.hasOwnProperty.call(g,v)){var y;h=C(v);var b=!1,T=!1,_=!1,S="";switch((y=g[v]?l(h):{type:"disposed",moduleId:v}).chain&&(S="\nUpdate propagation: "+y.chain.join(" -> ")),y.type){case"self-declined":t.onDeclined&&t.onDeclined(y),t.ignoreDeclined||(b=new Error("Aborted because of self decline: "+y.moduleId+S));break;case"declined":t.onDeclined&&t.onDeclined(y),t.ignoreDeclined||(b=new Error("Aborted because of declined dependency: "+y.moduleId+" in "+y.parentId+S));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(y),t.ignoreUnaccepted||(b=new Error("Aborted because "+h+" is not accepted"+S));break;case"accepted":t.onAccepted&&t.onAccepted(y),T=!0;break;case"disposed":t.onDisposed&&t.onDisposed(y),_=!0;break;default:throw new Error("Unexception type "+y.type)}if(b)return c("abort"),Promise.reject(b);if(T)for(h in x[h]=g[h],d(m,y.outdatedModules),y.outdatedDependencies)Object.prototype.hasOwnProperty.call(y.outdatedDependencies,h)&&(f[h]||(f[h]=[]),d(f[h],y.outdatedDependencies[h]));_&&(d(m,[y.moduleId]),x[h]=E)}var P,M=[];for(A=0;A<m.length;A++)h=m[A],w[h]&&w[h].hot._selfAccepted&&M.push({module:h,errorHandler:w[h].hot._selfAccepted});c("dispose"),Object.keys(I).forEach(function(e){!1===I[e]&&function(e){delete installedChunks[e]}(e)});for(var B,R,D=m.slice();D.length>0;)if(h=D.pop(),o=w[h]){var N={},Q=o.hot._disposeHandlers;for(n=0;n<Q.length;n++)(i=Q[n])(N);for(r[h]=N,o.hot.active=!1,delete w[h],delete f[h],n=0;n<o.children.length;n++){var L=w[o.children[n]];L&&((P=L.parents.indexOf(h))>=0&&L.parents.splice(P,1))}}for(h in f)if(Object.prototype.hasOwnProperty.call(f,h)&&(o=w[h]))for(R=f[h],n=0;n<R.length;n++)B=R[n],(P=o.children.indexOf(B))>=0&&o.children.splice(P,1);for(h in c("apply"),a=p,x)Object.prototype.hasOwnProperty.call(x,h)&&(e[h]=x[h]);var H=null;for(h in f)if(Object.prototype.hasOwnProperty.call(f,h)&&(o=w[h])){R=f[h];var O=[];for(A=0;A<R.length;A++)if(B=R[A],i=o.hot._acceptedDependencies[B]){if(-1!==O.indexOf(i))continue;O.push(i)}for(A=0;A<O.length;A++){i=O[A];try{i(R)}catch(e){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:h,dependencyId:R[A],error:e}),t.ignoreErrored||H||(H=e)}}}for(A=0;A<M.length;A++){var U=M[A];h=U.module,s=[h];try{F(h)}catch(e){if("function"==typeof U.errorHandler)try{U.errorHandler(e)}catch(i){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:h,error:i,originalError:e}),t.ignoreErrored||H||(H=i),H||(H=e)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:h,error:e}),t.ignoreErrored||H||(H=e)}}return H?(c("fail"),Promise.reject(H)):(c("idle"),new Promise(function(e){e(m)}))}var w={};function F(t){if(w[t])return w[t].exports;var i=w[t]={i:t,l:!1,exports:{},hot:l(t),parents:(o=s,s=[],o),children:[]};return e[t].call(i.exports,i,i.exports,h(t)),i.l=!0,i.exports}F.m=e,F.c=w,F.d=function(e,t,i){F.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},F.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},F.t=function(e,t){if(1&t&&(e=F(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(F.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var A in e)F.d(i,A,function(t){return e[t]}.bind(null,A));return i},F.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return F.d(t,"a",t),t},F.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},F.p="build/",F.h=function(){return a},h(14)(F.s=14)}([function(e,t,i){"use strict";i.d(t,"a",function(){return A});var A=function(e){THREE.DataTextureLoader.call(this,e),this.type=THREE.UnsignedByteType};A.prototype=Object.assign(Object.create(THREE.DataTextureLoader.prototype),{constructor:A,parse:function(e){var t=function(e,t){switch(e){case 1:console.error("RGBELoader Read Error: "+(t||""));break;case 2:console.error("RGBELoader Write Error: "+(t||""));break;case 3:console.error("RGBELoader Bad File Format: "+(t||""));break;default:case 4:console.error("RGBELoader: Error: "+(t||""))}return-1},i=function(e,t,i){t=t||1024;for(var A=e.pos,a=-1,n=0,r="",s=String.fromCharCode.apply(null,new Uint16Array(e.subarray(A,A+128)));0>(a=s.indexOf("\n"))&&n<t&&A<e.byteLength;)r+=s,n+=s.length,A+=128,s+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(A,A+128)));return-1<a&&(!1!==i&&(e.pos+=n+a+1),r+s.slice(0,a))},A=function(){var e=new Float32Array(1),t=new Int32Array(e.buffer);function i(i){e[0]=i;var A=t[0],a=A>>16&32768,n=A>>12&2047,r=A>>23&255;return r<103?a:r>142?(a|=31744,a|=(255==r?0:1)&&8388607&A):r<113?a|=((n|=2048)>>114-r)+(n>>113-r&1):(a|=r-112<<10|n>>1,a+=1&n)}return function(e,t,A,a){var n=e[t+3],r=Math.pow(2,n-128)/255;A[a+0]=i(e[t+0]*r),A[a+1]=i(e[t+1]*r),A[a+2]=i(e[t+2]*r)}}(),a=new Uint8Array(e);a.pos=0;var n,r,s,o,h,l,d=function(e){var A,a,n=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,r=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,s=/^\s*FORMAT=(\S+)\s*$/,o=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,h={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};if(e.pos>=e.byteLength||!(A=i(e)))return t(1,"no header found");if(!(a=A.match(/^#\?(\S+)$/)))return t(3,"bad initial token");for(h.valid|=1,h.programtype=a[1],h.string+=A+"\n";!1!==(A=i(e));)if(h.string+=A+"\n","#"!==A.charAt(0)){if((a=A.match(n))&&(h.gamma=parseFloat(a[1],10)),(a=A.match(r))&&(h.exposure=parseFloat(a[1],10)),(a=A.match(s))&&(h.valid|=2,h.format=a[1]),(a=A.match(o))&&(h.valid|=4,h.height=parseInt(a[1],10),h.width=parseInt(a[2],10)),2&h.valid&&4&h.valid)break}else h.comments+=A+"\n";return 2&h.valid?4&h.valid?h:t(3,"missing image size specifier"):t(3,"missing format specifier")}(a);if(-1!==d){var u=d.width,c=d.height,f=function(e,i,A){var a,n,r,s,o,h,l,d,u,c,f,g,p,m=i,x=A;if(m<8||m>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);if(m!==(e[2]<<8|e[3]))return t(3,"wrong scanline width");if(!(a=new Uint8Array(4*i*A))||!a.length)return t(4,"unable to allocate buffer space");for(n=0,r=0,d=4*m,p=new Uint8Array(4),h=new Uint8Array(d);x>0&&r<e.byteLength;){if(r+4>e.byteLength)return t(1);if(p[0]=e[r++],p[1]=e[r++],p[2]=e[r++],p[3]=e[r++],2!=p[0]||2!=p[1]||(p[2]<<8|p[3])!=m)return t(3,"bad rgbe scanline format");for(l=0;l<d&&r<e.byteLength;){if((g=(s=e[r++])>128)&&(s-=128),0===s||l+s>d)return t(3,"bad scanline data");if(g)for(o=e[r++],u=0;u<s;u++)h[l++]=o;else h.set(e.subarray(r,r+s),l),l+=s,r+=s}for(c=m,u=0;u<c;u++)f=0,a[n]=h[u+f],f+=m,a[n+1]=h[u+f],f+=m,a[n+2]=h[u+f],f+=m,a[n+3]=h[u+f],n+=4;x--}return a}(a.subarray(a.pos),u,c);if(-1!==f){switch(this.type){case THREE.UnsignedByteType:var g=f,p=THREE.RGBEFormat,m=THREE.UnsignedByteType;break;case THREE.FloatType:for(var x=f.length/4*3,E=new Float32Array(x),v=0;v<x;v++)s=E,o=3*v,h=void 0,l=void 0,h=(n=f)[(r=4*v)+3],l=Math.pow(2,h-128)/255,s[o+0]=n[r+0]*l,s[o+1]=n[r+1]*l,s[o+2]=n[r+2]*l;g=E,p=THREE.RGBFormat,m=THREE.FloatType;break;case THREE.HalfFloatType:x=f.length/4*3;var I=new Uint16Array(x);for(v=0;v<x;v++)A(f,4*v,I,3*v);g=I,p=THREE.RGBFormat,m=THREE.HalfFloatType;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type)}return{width:u,height:c,data:g,header:d.string,gamma:d.gamma,exposure:d.exposure,format:p,type:m}}}return null},setDataType:function(e){return this.type=e,this},load:function(e,t,i,A){return THREE.DataTextureLoader.prototype.load.call(this,e,function(e,i){switch(e.type){case THREE.UnsignedByteType:e.encoding=THREE.RGBEEncoding,e.minFilter=THREE.NearestFilter,e.magFilter=THREE.NearestFilter,e.generateMipmaps=!1,e.flipY=!0;break;case THREE.FloatType:case THREE.HalfFloatType:e.encoding=THREE.LinearEncoding,e.minFilter=THREE.LinearFilter,e.magFilter=THREE.LinearFilter,e.generateMipmaps=!1,e.flipY=!0}t&&t(e,i)},i,A)}})},function(e,t,i){"use strict";(function(e){i.d(t,"a",function(){return n});var A=i(11),a=i(10);var n=function t(i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),trace("######asd####"),this.type="Main",this.fun=i;var n=this;this.glaf=null,this._width=100,this._height=100,n.resolution=1,n.objectBase=null,n.confText=null,this.localStorage=void 0,this.debug=!1,this.contentHTML=document.createElement("div"),this.contentHTML.style.position="fixed",this.contentHTML.style.top="0px",this.contentHTML.style.left="0px",document.body.appendChild(this.contentHTML),e.mainBig=this,this.start=function(){this.tick(),this.localStorage=new a.a(null,"p3d"),null==n.localStorage.object.debug&&(n.localStorage.object.debug=!1),this.debug=n.localStorage.object.debug,this.fina()},this.fina=function(){n.glaf=new A.a(n),sizeWindow(),i("init")};var r,s=!0;this.tick=function(){1==(s=!s)&&(TWEEN.update(),n.glaf&&n.glaf.update()),requestAnimationFrame(n.tick)},this.boolCTRL=!1,this.keydown=function(e){17==event.keyCode&&(n.boolCTRL=!0),81==event.keyCode&&n.boolCTRL&&(n.localStorage.object.debug=!n.localStorage.object.debug,n.localStorage.save())},this.keyup=function(e){17==event.keyCode&&(n.boolCTRL=!1)},window.addEventListener("keydown",this.keydown),window.addEventListener("keyup",this.keyup),this.scale=1,this.sizeWindow=function(e,t){n._width=e,n._height=t,n._width<800&&(n._width=800),n._height<600&&(n._height=600),(r=e/n._width)>t/n._height&&(r=t/n._height),0==dcmParam.mobile&&(r=1),trace(r),1==dcmParam.isIE&&(r=1),r<.5&&(r=.5),this.scale=r,n.glaf&&n.glaf.sizeWindow(e,t,this.scale)},$.ajax({url:"resources/config.json",success:function(e){if("string"==typeof e){var t=JSON.parse(e);n.objectBase=t}else n.objectBase=e;n.start()},error:function(e){console.log("Что то случилось с конфигом")}})}}).call(this,i(6))},function(e,t,i){"use strict";i.d(t,"a",function(){return a});var A=i(0);function a(e){this.parent=e;var t,i=this;this._active=!1,this.RADIUS=1e3,this.POS_X=0,this.POS_Y=0,this.POS_Z=0,this.LINK="null",this.COLOR="0xffffff",this._radius=this.RADIUS,this._link=this.LINK,this._color=this.COLOR,this._shadRotZ=this.parent.ROTATION_Z,this._rotZ=0,this._x=this.POS_X,this._y=this.POS_Y,this._z=this.POS_Z,this.mesh=void 0,this.cont3d=void 0,this.cont3d1=void 0,this.textur=void 0,this.loaderHDR=void 0,this.init=function(){null==this.mesh&&(this.geometry=new THREE.SphereGeometry(1,32,32),this.loader=new THREE.TextureLoader,this.loaderHDR=new A.a,this.material=new THREE.MeshBasicMaterial({side:THREE.BackSide,color:16777215}),this.mesh=new THREE.Mesh(this.geometry,this.material),this.mesh.scale.set(this._radius,this._radius,this._radius),this.cont3d=new THREE.Object3D,this.cont3d1=new THREE.Object3D,this.cont3d.add(this.cont3d1),this.cont3d1.add(this.mesh),this.cont3d1.rotation.y=0,this.mesh.rotation.y=this._rotZ,this.cont3d.rotation.x=-Math.PI/2)},this.dergActiv=function(){1==this._active?null==this.cont3d.parent&&this.parent.parent.groupObject.add(this.cont3d):null!=this.cont3d.parent&&this.parent.parent.groupObject.remove(this.cont3d)},this.dergLink=function(){if("null"==this._link)null!=this.material.map&&(this.material.map=null,this.material.needsUpdate=!0);else if(0==(t=this.checkFormat(this._link))&&this.loader.load(this._link,function(e){i.textur=e,i.material.map=e,i.material.needsUpdate=!0,i.parent.parent.intRend=1}),1==t)return void console.log("Подключи в загрущик RGBELoader токо если надо hdr загрузить!!!")},this.checkFormat=function(e){return-1!==e.indexOf(".png")?0:-1!==e.indexOf(".jpeg")?0:-1!==e.indexOf(".jpg")?0:e.length>150?-1!==e.indexOf("png")?0:-1!==e.indexOf("jpeg")?0:-1!==e.indexOf("jpg")?0:1:1},this.render=function(){}}a.prototype={set x(e){this._x!==e&&(this._x=e,this.cont3d.position.x=e,this.parent.parent.intRend=1)},get x(){return this._x},set y(e){this._y!==e&&(this._y=e,this.cont3d.position.y=e,this.parent.parent.intRend=1)},get y(){return this._y},set z(e){this._z!==e&&(this._z=e,this.cont3d.position.z=e,this.parent.parent.intRend=1)},get z(){return this._z},set active(e){this._active!==e&&(this._active=e,this.init(),this.dergActiv())},get active(){return this._active},set radius(e){this._radius!==e&&(this._radius=e,null!=this.mesh&&this.mesh.scale.set(this._radius,this._radius,this._radius))},get radius(){return this._radius},set link(e){this._link!==e&&(this._link=e,this.init(),this.dergLink())},get link(){return this._link},set color(e){if(this._color!==e){this._color=e,this.init();var t=this._color;if("string"==typeof t&&-1!=t.indexOf("x")){var i=t.split("x");t="#"+i[1]}this.material.color=new THREE.Color(t)}},get color(){return this._color}}},function(e,t,i){"use strict";function A(){var e=this,t=256,i=256,A=new THREE.Scene,a=new THREE.OrthographicCamera(t/-2,t/2,i/2,i/-2,.001,1e4),n=(new THREE.Clock,new THREE.WebGLRenderer({antialias:!0,alpha:!0,preserveDrawingBuffer:!0}));a.position.set(200,200,200),A.add(a),this.camera=a,this.fotoContainer=new THREE.Object3D,A.add(this.fotoContainer),A.background=new THREE.Color(38655),n.setPixelRatio(window.devicePixelRatio),n.setSize(t,i),n.localClippingEnabled=!0;var r=document.createElement("div");r.style.position="absolute",r.style.bottom="0px",r.style.left="0px",r.appendChild(n.domElement),this.contentHTML=r,this.canvas=n.domElement,this.contentHTML=r;var s=new THREE.AmbientLight("#ffffff",1);A.add(s);var o=new THREE.GridHelper(1e3,10),h=new THREE.AxesHelper(100),l=new THREE.BoxHelper(this.fotoContainer,16776960);A.add(o),A.add(h),A.add(l);var d=[h,o,l];function u(){n.render(A,a)}this.render=u,u(),l.setFromObject(e.fotoContainer);var c=new THREE.Box3,f=new THREE.Vector3;this.box=c,this.center=f,this.setSize=function(e,A){t=e,i=A,n.setSize(t,i),a.aspect=t/i,a.updateProjectionMatrix()},this.addObjFoto=function(e){this.fotoContainer.add(e),l.setFromObject(this.fotoContainer)},this.removeObjFoto=function(e){this.fotoContainer.remove(e)},this.moveToObj=function(t){c.setFromObject(t||e.fotoContainer);var i=c.max.x-c.min.x,A=c.max.z-c.min.z;e.moveToRect(c.min.x,c.min.z,i,A)},this.moveToRect=function(e,t,i,A){if(e+=i/2,t+=A/2,f.set(e,0,t),a.position.set(f.x,9e3,f.z),a.lookAt(f),"OrthographicCamera"===a.type){var n=Math.max(A,i);a.zoom=1,a.left=n/-2,a.right=n/2,a.top=n/2,a.bottom=n/-2,a.aspect=n/n}a.updateProjectionMatrix()},this.getFoto=function(e){e=e||1024;for(var a=0;a<d.length;a++)d[a].visible=!1;var r=A.background;A.background=null,n.setSize(e,e),u();var s=n.domElement.toDataURL("image/png");n.setSize(t,i),A.background=r;for(var o=0;o<d.length;o++)d[o].visible=!0;return u(),s},this.getCanvas=function(e){e=e||1024;for(var t=0;t<d.length;t++)d[t].visible=!1;A.background;A.background=null;var i=n.getSize();return i.width==e&&i.height==e||n.setSize(e,e),u(),n.domElement}}function a(e){var t=this,i=THREE.Math.generateUUID(),a=new THREE.Vector3(0,1,0),o=(new THREE.Plane(a,.01),new THREE.Vector4(0,999,0,.001)),h=new THREE.Box3,l=e||new A;this.foto3D=l;var d=new THREE.Vector2(0,0),u=100,c=new r;this.canvas=c.canvas,this.isTime=!1;var f=new THREE.Texture(c.canvas);this.texturePlan=f,this.matPlan=new THREE.MeshPhongMaterial({transparent:!0,side:THREE.DoubleSide,map:f});var g=new s;this.canvasGG=g,g.arrColorStopTranspanent[0]=.15,g.arrProcent[0]=.82,g.arrColorStopTranspanent[1]=1,g.arrProcent[1]=1,g.update();var p=new THREE.Texture(g.canvas);p.needsUpdate=!0,this.textureShadow=p,this.content3d=new THREE.Object3D,this.shadowContent3d=new THREE.Object3D,this.meshPlan=new THREE.Mesh(new THREE.PlaneBufferGeometry(1,1),this.matPlan),this.meshPlan.rotation.x=-Math.PI/2,this.content3d.add(this.meshPlan);var m=new THREE.Mesh(new THREE.SphereBufferGeometry(10,16,16));m.position.set(o.x,o.y,o.z),this.arrShadowMesh=[],this.arrObj=[],this._dunamic=!0,this.dirty=!0,this._lightPosition4D=o,this._fotoPosition=new THREE.Vector2(0,0),this._fotoWH=150,this._imgWH=512,this._imgBlur=1,this._imgAlpha=1,this._offsetY=0,this._scaleShadow=1,this._isDinamFotoRect=!1,this._opacityMat=1;var x=[new THREE.Plane(new THREE.Vector3(0,-1,0),100),new THREE.Plane(new THREE.Vector3(0,1,0),0)];this._shadowMaterial=new THREE.MeshBasicMaterial({side:THREE.DoubleSide,transparent:!0,opacity:this._opacityMat,depthWrite:!1,map:p,clippingPlanes:x,clipIntersection:!1}),this.arrDataSempl=[],this.arrDataSempl.push(new n(0,200,3,1));var E=new THREE.Group;this.content3d.add(E);var v=new THREE.Mesh(new THREE.PlaneBufferGeometry(1,1),new THREE.MeshBasicMaterial({side:THREE.DoubleSide,map:p,transparent:!0}));v.scale.set(1,30,1),v.rotation.z=-Math.PI/2,E.add(v),E.visible=!1,this.helpers=E,this.setConstMax=function(e){x[0].constant=e},this.setConstMin=function(e){x[1].constant=-e},this.addObj=function(e){if(-1==t.arrObj.indexOf(e)){e.updateMatrixWorld();var i=e.clone();!function e(t,i){t.userData.targetObject=i;for(var A=0;A<t.children.length;A++){if(!i.children[A])throw new Error("обекты не одинаковы");e(t.children[A],i.children[A])}}(i,e),function(e){var i=[];!function e(t,i){"Mesh"==t.type&&i.push(t);for(var A=0;A<t.children.length;A++)"Mesh"==t.type?i.push(t.children[A]):e(t.children[A],i)}(e,i);for(var A=0;A<i.length;A++)i[A].material=t._shadowMaterial}(i),t.arrShadowMesh.push(i),t.arrObj.push(e),t.shadowContent3d.add(i),this.dirty=!0}},this.removeObj=function(e){var i=t.arrObj.indexOf(e);-1!=i&&(t.arrObj.splice(i,1),t.shadowContent3d.remove(t.arrShadowMesh[i]),t.arrShadowMesh.splice(i,1),this.dirty=!0)},this.clear=function(){for(var e=0;(e=t.arrObj.length)>0;)if(t.removeObj(t.arrObj[e-1]),e===t.arrObj.length)throw new Error("object not remove")},this.intRend=1,this.intRendOk=1,this.upDate=function(){t.opacityMat&&(t.dunamic&&(t.intRend=t.intRendOk),t.intRend==t.intRendOk&&(t.dirty||function(){for(var e=0;e<t.arrShadowMesh.length;e++)if((t._isDinamFotoRect||I(t.arrShadowMesh[e]))&&C(t.arrShadowMesh[e]))return!0;return!1}())&&t.render(),t.intRend++)};function I(e){var i=!1,A=!1,a=h.min.x,n=h.min.z,r=h.max.x-h.min.x,s=h.max.z-h.min.z;if(h.setFromObject(e.userData.targetObject),i=S(a=h.min.x,n=h.min.z,r=h.max.x-h.min.x,s=h.max.z-h.min.z,t.fotoPosition.x,t.fotoPosition.y,t.fotoWH,t.fotoWH),h.setFromObject(e),A=S(a=h.min.x,n=h.min.z,r=h.max.x-h.min.x,s=h.max.z-h.min.z,t.fotoPosition.x,t.fotoPosition.y,t.fotoWH,t.fotoWH),!i&&!A)return!1;i=!1,A=!1;for(var o=0;o<e.children.length;o++)if(h.setFromObject(e.children[o].userData.targetObject),a=h.min.x,n=h.min.z,r=h.max.x-h.min.x,s=h.max.z-h.min.z,i=i||S(a,n,r,s,t.fotoPosition.x,t.fotoPosition.y,t.fotoWH,t.fotoWH),h.setFromObject(e.children[o]),a=h.min.x,n=h.min.z,r=h.max.x-h.min.x,s=h.max.z-h.min.z,A=A||S(a,n,r,s,t.fotoPosition.x,t.fotoPosition.y,t.fotoWH,t.fotoWH),i||A)return!0;return!0}function C(e){if(!function(e,t){if(e.position.equals(t.position)&&e.quaternion.equals(t.quaternion)&&e.scale.equals(t.scale)&&e.visible===t.visible)return!0;return!1}(e,e.userData.targetObject))return!0;for(var t=0;t<e.children.length;t++)if(C(e.children[t]))return!0;return!1}function y(e){!function(e,t){e.position.copy(t.position),e.quaternion.copy(t.quaternion),e.scale.copy(t.scale),e.visible=t.visible}(e,e.userData.targetObject);for(var t=0;t<e.children.length;t++)y(e.children[t])}this.render=function(){t.isTime&&console.time("render "+i),t.dirty=!1,function(){o.w=.001,m.position.set(o.x,o.y,o.z);for(var e=0;e<t.arrShadowMesh.length;e++)y(t.arrShadowMesh[e]);w()}(),l.addObjFoto(t.shadowContent3d),u=t.fotoWH,d.x=t.fotoPosition.x,d.y=t.fotoPosition.y,t.isDinamFotoRect&&(h.setFromObject(t.shadowContent3d),d.x=h.min.x,d.y=h.min.z,u=Math.max(h.max.x-h.min.x,h.max.z-h.min.z),d.x-=100,d.y-=100,u+=200),l.moveToRect(d.x,d.y,u,u),function(){var e=l.getCanvas(t.imgWH);c.setCanvas(e),0==t.arrDataSempl.length&&c.update();for(var i=0;i<t.arrDataSempl.length;i++)t.setConstMin(t.arrDataSempl[i].min*t._scaleShadow+t._offsetY),t.setConstMax(t.arrDataSempl[i].max*t._scaleShadow+t._offsetY),l.render(),c._blur=t.arrDataSempl[i].blur+(t._scaleShadow>1?t._scaleShadow:0),c._alpha=t.arrDataSempl[i].alpha,c.update();t.setConstMin(-999999),t.setConstMax(999999),f.needsUpdate=!0}(),t.meshPlan.scale.set(u,u,1),t.meshPlan.position.set(d.x+u/2,0,d.y+u/2),t.isTime&&console.timeEnd("render "+i),t.onUpdate&&t.onUpdate()};var b=new THREE.Box3(new THREE.Vector3,new THREE.Vector3(300,300,300));this.boundingBoxUv=b;var T=new THREE.Vector3;function _(e){if("Mesh"===e.type){var i=!1,A=e.getWorldPosition(e.position),a=e.getWorldQuaternion(e.quaternion),n=t.maxHeight;A.y-=t._offsetY,e.userData.pos?e.userData.pos.y!=A.y?i=!0:e.userData.rot.equals(a)?e.userData.maxHeight!==n?i=!0:e.userData.scaleShadow!==t._scaleShadow&&(i=!0):i=!0:i=!0,t._isDinamFotoRect||(h.setFromObject(e),S(h.min.x,h.min.z,h.max.x-h.min.x,h.max.z-h.min.z,t.fotoPosition.x,t.fotoPosition.y,t.fotoWH,t.fotoWH)||(i=!1)),i&&(!function(e){e.geometry.uuid===e.userData.targetObject.geometry.uuid&&(e.geometry=e.userData.targetObject.geometry.clone());var i=b,A=0;if(e.geometry instanceof THREE.Geometry){for(var a=e.geometry.faces,n=e.geometry.vertices,r=e.geometry.faceVertexUvs[0],s=0;s<a.length;s++)T.set(n[a[s].a].x,n[a[s].a].y,n[a[s].a].z),e.localToWorld(T),A=1-P(T.y-t._offsetY,i.min.y,i.min.y+i.max.y)/100,r[s][0].set(A,A),T.set(n[a[s].b].x,n[a[s].b].y,n[a[s].b].z),e.localToWorld(T),A=1-P(T.y-t._offsetY,i.min.y,i.min.y+i.max.y)/100,r[s][1].set(A,A),T.set(n[a[s].c].x,n[a[s].c].y,n[a[s].c].z),e.localToWorld(T),A=1-P(T.y-t._offsetY,i.min.y,i.min.y+i.max.y)/100,r[s][2].set(A,A);e.geometry.uvsNeedUpdate=!0}else{var o=e.geometry.attributes.position.array;e.geometry.attributes.uv||(arrUvAttribut=new Float32Array(o.length/3*2),e.geometry.addAttribute("uv",new THREE.BufferAttribute(arrUvAttribut,2)));var h=e.geometry.attributes.uv.array,l=(e.geometry.attributes.uv.itemSize,e.geometry.index.array),d=e.geometry.index.count;for(s=0;s<d;s++){var u=l[s],c=3*u,f=2*u;T.set(o[c],o[c+1],o[c+2]),e.localToWorld(T),A=1-P(T.y-t._offsetY,i.min.y,i.min.y+i.max.y*t._scaleShadow)/100,h[f]=A,h[f+1]=A}e.geometry.attributes.uv.needsUpdate=!0}}(e),e.userData.pos=A,e.userData.rot=a,e.userData.maxHeight=n,e.userData.scaleShadow=t._scaleShadow)}for(var r=0;r<e.children.length;r++)_(e.children[r])}function w(){v.scale.x=(t.boundingBoxUv.max.y||1)*t._scaleShadow,v.position.y=v.scale.x/2+t.boundingBoxUv.min.y;for(var e=0;e<t.arrShadowMesh.length;e++)(t._isDinamFotoRect||(h.setFromObject(t.arrShadowMesh[e]),S(h.min.x,h.min.z,h.max.x-h.min.x,h.max.z-h.min.z,t.fotoPosition.x,t.fotoPosition.y,t.fotoWH,t.fotoWH)))&&_(t.arrShadowMesh[e])}this.updateShadowUv=w,this.updateShadowTexture=function(){this.canvasGG.update(),this.textureShadow.needsUpdate=!0},this.setShadowColor=function(e,i,A){g.r=e,g.g=i,g.b=A,t.updateShadowTexture()},this.getConfig=function(){var e={};return e.imgWH=t.imgWH,e.fotoPosition={x:t._fotoPosition.x,y:t._fotoPosition.y},e.fotoWH=t.fotoWH,e.maxHeight=t.maxHeight,e.isDinamFotoRect=t.isDinamFotoRect,e.arrDataSempl=t.arrDataSempl,e.opacityMat=t.opacityMat,e.dunamic=t.dunamic,e.canvasGG={arrColorStopTranspanent:t.canvasGG.arrColorStopTranspanent,arrProcent:t.canvasGG.arrProcent},e},this.setConfig=function(e){t.canvasGG.arrColorStopTranspanent=e.canvasGG.arrColorStopTranspanent,t.canvasGG.arrProcent=e.canvasGG.arrProcent,t.fotoPosition.x=e.fotoPosition.x,t.fotoPosition.y=e.fotoPosition.y,t.fotoWH=e.fotoWH,t.isDinamFotoRect=e.isDinamFotoRect,t.arrDataSempl=e.arrDataSempl,t.opacityMat=e.opacityMat,t.imgWH=e.imgWH,t.dunamic=e.dunamic,t.updateShadowTexture(),t.maxHeight=e.maxHeight};var F={imgWH:1024,fotoPosition:{x:0,y:0},fotoWH:150,maxHeight:300,isDinamFotoRect:!1,arrDataSempl:[{min:0,max:6,blur:.8,alpha:.25},{min:4,max:15,blur:3,alpha:.64},{min:10,max:23,blur:4,alpha:.5},{min:15,max:50,blur:15,alpha:1},{min:20,max:198.09,blur:15,alpha:.7},{min:0,max:2,blur:1.02,alpha:1}],opacityMat:1,dunamic:!0,canvasGG:{arrColorStopTranspanent:[0,1,.25],arrProcent:[.4,1,.96]}};function S(e,t,i,A,a,n,r,s){return e<a+r&&t<n+s&&e+i>a&&t+A>n}function P(e,t,i,A){return t=null!=t?t:0,i=null!=i?i:100,A=A||100,isNaN(parseFloat(e))&&(e=t),e<t&&(e=t),e>i&&(e=i),e=Math.round(e*A)/A,t<0?100*(Math.abs(t)+e)/(Math.abs(t)+Math.abs(i)||1):100*(Math.abs(t)-e)/(Math.abs(t)-Math.abs(i)||1)}this.sss=F,this.setConfig(F),this.getBase64=function(){return t.render(),c.canvas.toDataURL()},this.debug=!1}function n(e,t,i,A){this.min=e||0,this.max=t||1,this.blur=i||0,this.alpha=A||1}function r(){var e=this,t=document.createElement("canvas");this.canvas=t,t.width=256,t.height=256;var i=t.getContext("2d"),A=new Image;this.b64=null,this._blur=0,this._blur1=1,this._alpha=1,this.image=new Image,this.setBase64=function(i,a){this.b64=i,(A=new Image).onload=function(){t.clearRect(0,0,t.width,t.height),t.width=A.width,t.height=A.height,e.update(),a&&a(t.toDataURL())},A.src=i},this.setCanvas=function(e){A=e,t.width=e.width,t.height=e.height},this.update=function(){i.filter="blur("+e._blur+"px)",i.globalAlpha=e._alpha,i.drawImage(A,0,0)}}function s(){var e=this,t=document.createElement("canvas");t.width=t.height=256,this.canvas=t;var i=t.getContext("2d");this._blur=0,this._alpha=1,this.arrColorStopTranspanent=[0,1],this.arrProcent=[0,1],this.position=new THREE.Vector2,this.position1=new THREE.Vector2(1,0),this.r=0,this.g=0,this.b=0,this.update=function(){var A=t.width,a=t.height;i.clearRect(0,0,A,a),i.rect(0,0,A,a),i.filter="blur("+e._blur+"px)",i.globalAlpha=e._alpha;for(var n=e.position.x*A,r=e.position.y*a,s=e.position1.x*A,o=e.position1.y*a,h=i.createLinearGradient(n,r,s,o),l=0;l<e.arrColorStopTranspanent.length;l++)h.addColorStop(e.arrProcent[l],"rgba("+e.r+","+e.g+","+e.b+","+e.arrColorStopTranspanent[l]+")");i.fillStyle=h,i.fill()},this.update()}function o(e){this.parent=e;this._active=!1,this._visible=!0,this.WH=512,this._wn=this.WH,this._obj3d=void 0,this.smc=void 0,this.init=function(){null==this.smc&&(this.smc=new a,this.smc.fotoPosition.set(-this._wn/2,-this._wn/2),this.smc.fotoWH=this._wn,this.smc.content3d.rotation.x=-Math.PI/2,this.smc.content3d.position.y=-1,this.smc.content3d.visible=this._visible,this.dergObj())},this.dergActiv=function(){1==this._active?null==this.smc.content3d.parent&&this.parent.parent.groupObject.add(this.smc.content3d):null!=this.smc.content3d.parent&&this.parent.parent.groupObject.remove(this.smc.content3d)},this.render=function(){null!=this.smc&&null!=this.smc.content3d.parent&&this.smc.upDate()},this.dergObj=function(){null!=this.smc&&(null!=this._obj3d?this.smc.arrObj[0]==this._obj3d||(this.smc.clear(),this.smc.addObj(this._obj3d)):this.smc.clear())}}Object.defineProperties(a.prototype,{scaleShadow:{set:function(e){this.dirty=!0,this._scaleShadow=e},get:function(){return this._scaleShadow}},debug:{set:function(e){this.helpers.visible=e},get:function(){return this.helpers.visible}},offsetY:{set:function(e){this._offsetY=e,this.dirty=!0},get:function(){return this._offsetY}},maxHeight:{set:function(e){this.dirty=!0,this.boundingBoxUv.max.y=e,this.updateShadowUv()},get:function(){return this.boundingBoxUv.max.y}},dunamic:{set:function(e){this.dirty=!0,this._dunamic=e},get:function(){return this._dunamic}},fotoPosition:{set:function(e){this.dirty=!0,this._fotoPosition=e},get:function(){return this._fotoPosition}},fotoWH:{set:function(e){this.dirty=!0,this._fotoWH=e},get:function(){return this._fotoWH}},imgWH:{set:function(e){this.dirty=!0,this._imgWH=e},get:function(){return this._imgWH}},imgBlur:{set:function(e){this.dirty=!0,this._imgBlur=e},get:function(){return this.dirty=!0,this._imgBlur}},imgAlpha:{set:function(e){this.dirty=!0,this._imgAlpha=e},get:function(){return this._imgAlpha}},isDinamFotoRect:{set:function(e){this.dirty=!0,this._isDinamFotoRect=e},get:function(){return this._isDinamFotoRect}},opacityMat:{set:function(e){this.dirty=!0,this._opacityMat=e,this.matPlan.opacity=this._opacityMat},get:function(){return this._opacityMat}},shadowMaterial:{set:function(e){if(e!==this._shadowMaterial){this._shadowMaterial=e;for(var t=0;t<this.arrShadowMesh.length;t++)if(this.arrShadowMesh[t]instanceof THREE.ShadowMesh)this.arrShadowMesh[t].material=this._shadowMaterial;else for(var i=0;i<this.arrShadowMesh[t].children.length;i++)this.arrShadowMesh[t].children[i]instanceof THREE.ShadowMesh&&(this.arrShadowMesh[t].children[i].material=this._shadowMaterial)}},get:function(){return this._shadowMaterial}},lightPosition4D:{set:function(e){this._lightPosition4D.set(e.x,e.y,e.z,.001)},get:function(){return this._lightPosition4D}}}),Object.defineProperties(r.prototype,{blur:{set:function(e){this._blur=e},get:function(){return this._blur}},alpha:{set:function(e){this._alpha=e},get:function(){return this._alpha}}}),Object.defineProperties(s.prototype,{}),i.d(t,"a",function(){return o}),o.prototype={set active(e){this._active!==e&&(this._active=e,this.init(),this.dergActiv())},get active(){return this._active},set visible(e){this._visible!==e&&(this._visible=e,null!=this.smc&&(this.smc.content3d.visible=e))},get visible(){return this._visible},set obj3d(e){this._obj3d!==e&&(this._obj3d=e,this.dergObj())},get obj3d(){return this._obj3d},set wh(e){this._wh!==e&&(this._wh=e,null!=this.smc&&(this.smc.fotoPosition.set(-this._wn/2,-this._wn/2),this.smc.fotoWH=this._wn))},get wh(){return this._wh}}},function(e,t,i){"use strict";var A=i(2),a=i(3);function n(e){var t=this;this.visi3D=e,this.box3=new THREE.Box3,this.rectScreen=new s,this.world=new s(0,0,100,100),this.targetObject=null,this.arrPoint=[],this.isMoveCam=!1,this.isFromGeometry=!1,this._offset=0,this._active=!0,this._debug=!1;var i=new THREE.Vector2,A=new THREE.Vector2,a=new THREE.Vector3;function n(){t.zumeVisi3D(),i.set(t.world.x+t.world.width/2,t.world.y+t.world.height/2),A.set(t.rectScreen.x+t.rectScreen.width/2,t.rectScreen.y+t.rectScreen.height/2),i.sub(A).divideScalar(2)}this.upDate=function(){if(t.active&&(this.updateBound3d(),!t.box3.isEmpty())){if(this.visi3D.xVerh=a.x,this.visi3D.zVerh=a.z,this.visi3D.yVerh=-a.y,t.zumeVisi3D(),t.isMoveCam){n();for(var e=0;i.length()>2&&++e<10;)this.visi3D.position3d.moveCamXY(i),n()}t.debugFocus&&t.debugFocus.upDate()}},this.zumeVisi3D=function(){for(var e,i,A=0,a=6e4,n=0;A<a&&!(++n>20)&&(i=e=(A+a)/2,t.visi3D.zume=i,!(Math.abs(A-e)<.01||Math.abs(a-e)<.01||e<.01));)t.updateRectScreen(),t.isZoomIn()?a=e:A=e+1},this.updateBound3d=function(){if(t.box3.makeEmpty(),t.targetObject)t.box3.copy(t.getCompoundBoundingBox(t.targetObject));else for(var e=0;e<t.arrPoint.length;e++)t.box3.expandByPoint(t.arrPoint[e]);t.box3.getCenter(a)},this.updateRectScreen=function(){if(this.visi3D.camera.updateMatrixWorld(),this.visi3D.scene.updateMatrixWorld(),t.targetObject&&t.isFromGeometry){var e=t.getBoxObject(t.targetObject);t.box3.copy(e.box3),t.box3.getCenter(a),t.setRectFromBox(t.rectScreen,e.box2)}else t.setRectFromBox(t.rectScreen,t.boxToScreen(t.box3));t.updateWorldSize()},this.setRectFromBox=function(e,t){e.x=t.min.x,e.y=t.min.y,e.width=t.max.x-t.min.x,e.height=t.max.y-t.min.y},this.getCompoundBoundingBox=function(){var e=new THREE.Box3,t=new THREE.Box3;function i(i){var A=i.geometry;void 0!==A&&(A.boundingBox||A.computeBoundingBox(),t.copy(A.boundingBox),t.applyMatrix4(i.matrixWorld),e.union(t))}return function(t){return t.updateMatrixWorld(!0),e.makeEmpty(),t.traverseVisible(i),e}}(),this.boxToScreen=function(){for(var e=new THREE.Box2,i=[],A=0;A<8;A++)i[A]=new THREE.Vector3;return function(A){e.makeEmpty(),i[0].set(A.min.x,A.min.y,A.min.z),i[1].set(A.min.x,A.max.y,A.min.z),i[2].set(A.max.x,A.min.y,A.min.z),i[3].set(A.max.x,A.max.y,A.min.z),i[4].set(A.min.x,A.min.y,A.max.z),i[5].set(A.min.x,A.max.y,A.max.z),i[6].set(A.max.x,A.min.y,A.max.z),i[7].set(A.max.x,A.max.y,A.max.z);for(var a=0;a<i.length;a++)e.expandByPoint(t.toScreenXY(i[a]));return e}}(),this.getBoxObject=function(){var e,i,A=new THREE.Box2,a=new THREE.Box3,n={box2:A,box3:a},r=new THREE.Vector3;function s(n){var s=n.geometry;if(void 0!==s)if(s.isGeometry){var o=s.vertices;for(e=0,i=o.length;e<i;e++)r.copy(o[e]).applyMatrix4(n.matrixWorld),a.expandByPoint(r),A.expandByPoint(t.toScreenXY(r))}else if(s.isBufferGeometry){var h=s.attributes.position;if(void 0!==h)for(e=0,i=h.count;e<i;e++)r.fromBufferAttribute(h,e).applyMatrix4(n.matrixWorld),a.expandByPoint(r),A.expandByPoint(t.toScreenXY(r))}}return function(e){return e.updateMatrixWorld(!0),A.makeEmpty(),a.makeEmpty(),e.traverseVisible(s),n}}();var r=new THREE.Vector2,o=new THREE.Vector3;this.toScreenXY=function(e){return o.copy(e),o.project(t.visi3D.camera),r.x=Math.round((o.x+1)*t.visi3D._width/2),r.y=Math.round((1-o.y)*t.visi3D._height/2),r},this.updateWorldSize=function(){t.world.x=t.offset,t.world.y=t.offset,t.world.width=this.visi3D._width-2*t.offset,t.world.height=this.visi3D._height-2*t.offset},this.isZoomIn=function(){return t.rectScreen.x>t.world.x&&t.rectScreen.x+t.rectScreen.width<t.world.x+t.world.width&&t.rectScreen.y>t.world.y&&t.rectScreen.y+t.rectScreen.height<t.world.y+t.world.height}}function r(e){var t=this;this.mFocus=e;var i=visi3D.scene,A=main.stage,a=new BoxHelper(1,materialAlphaRed);i.add(a);var n=new PIXI.Graphics;n.hitArea=new PIXI.Rectangle(0,0,0,0),A.addChild(n),t.active=!1,a.visible=n.visible=t.active,this.upDate=function(){a.visible=n.visible=t.active,t.active&&(n.clear(),n.position.set(visi3D._x,visi3D._y),n.lineStyle(1,0,1),n.drawRect(e.world.x,e.world.y,e.world.width,e.world.height),n.lineStyle(1,16711680,1),n.drawRect(e.rectScreen.x,e.rectScreen.y,e.rectScreen.width,e.rectScreen.height),a.width=e.box3.max.x-e.box3.min.x,a.depth=e.box3.max.y-e.box3.min.y,a.height=e.box3.max.z-e.box3.min.z,e.box3.getCenter(a.position))}}function s(e,t,i,A,a){this._x=e||0,this._y=t||0,this._width=void 0!==i?i:100,this._height=void 0!==A?A:100,this.angel=0,this.p=new o,this.fun,this.set=function(e,t,i,A){this._x=e||0,this._y=t||0,this._width=void 0!==i?i:100,this._height=void 0!==A?A:100},this.setRect=function(e){this._x=e.x,this._y=e.y,this._width=e.width,this._height=e.height,this.p.setPoint(e.p),this.angel=e.angel}}function o(e,t,i){this._x=e||0,this._y=t||0,this._z=i||0,this.xx=0,this.yy=0,this.zz=0,this.set=function(e,t,i){this._x=e||0,this._y=t||0,void 0!==i&&(this._z=i)},this.setPoint=function(e){this._x=e.x,this._y=e.y,void 0!==e.z&&(this._z=e.z)},this.getObj=function(){var e={};return e.x=this._x,e.y=this._y,e.z=this._z,e},this.copy=function(){return new o(this._x,this._y,this._z)}}function h(e){var t=this;this.parent=e,this._debug=!1,this.debugInit=!1,this.shadowHelper=void 0,this.spotLightHelper=void 0,this.gridHelper=void 0,this.FIXATION=!1,this.ROTATION_X=0,this.ROTATION_Z=0,this.DISTANCE=this.parent.DISTANCE,this.CUB_HEIGHT=this.parent.CUB_HEIGHT,this.CUB_WIDTH=this.parent.CUB_WIDTH,this.SKY_X=0,this.SKY_Y=0,this.SKY_Z=0,this._fixation=this.FIXATION,this._rotationX=this.ROTATION_X,this._rotationZ=this.ROTATION_Z,this._distance=this.DISTANCE,this._cubHeight=this.CUB_HEIGHT,this._cubWidth=this.CUB_WIDTH,this.sky=new A.a(this),this.smc=new a.a(this),this.focus=new n(this.parent),this.funDebug=function(){1!=this.debugInit&&(this.debugInit=!0,this.plane=new THREE.Mesh(new THREE.PlaneBufferGeometry(1e3,1e3).rotateX(-Math.PI),new THREE.MeshPhongMaterial({color:11316396,transparent:!0,opacity:.5})),this.plane.castShadow=this.plane.receiveShadow=!0,this.plane.position.z=2,this.plane.renderOrder=1,this.gridHelper=new THREE.GridHelper(1e3,10),this.gridHelper.rotation.x=-Math.PI/2,this.shadowHelper=new THREE.CameraHelper(this.parent.sunLight.shadow.camera),this.parent.sunLight&&(this.spotLightHelper=new THREE.DirectionalLightHelper(this.parent.sunLight))),1==this._debug?(null==this.gridHelper.parent&&this.parent.groupObject.add(this.gridHelper),null==this.plane.parent&&this.parent.groupObject.add(this.plane),null==this.shadowHelper.parent&&this.parent.scene.add(this.shadowHelper),this.parent.sunLight&&(null!=this.parent.sunLight.parent||(null!=this.spotLightHelper.parent&&this.parent.scene.remove(this.spotLightHelper),null!=this.shadowHelper.parent&&this.parent.scene.remove(this.shadowHelper)))):(null!=this.gridHelper.parent&&this.parent.groupObject.remove(this.gridHelper),null!=this.plane.parent&&this.parent.groupObject.remove(this.plane),null!=this.shadowHelper.parent&&this.parent.scene.remove(this.shadowHelper),this.parent.sunLight&&null!=this.spotLightHelper.parent&&this.parent.scene.remove(this.spotLightHelper))},this.render=function(){1==this._debug&&null!=this.spotLightHelper&&this.spotLightHelper.update(),this.smc.render(),this.sky.render(),this.focus.upDate(),this.dragSunLight()};var i=0;this.dragSunLight=function(){var e;null!=this.parent.sunLight&&(null!=this.parent.sunLight.parent&&(!0===t._fixation?(i=this._distance+2*this._cubHeight,t.parent.sunLight.position.set(0,i,0),t.parent.sunLight.position.applyAxisAngle(new THREE.Vector3(1,0,0),t._rotationX),t.parent.sunLight.position.applyAxisAngle(new THREE.Vector3(0,1,0),t._rotationZ-t.parent._rotationZ)):(i=this._distance+this._cubHeight,this.parent.sunLight.position.set(0,i,0),this.parent.sunLight.position.applyAxisAngle(new THREE.Vector3(1,0,0),this._rotationX),this.parent.sunLight.position.applyAxisAngle(new THREE.Vector3(0,1,0),this._rotationZ),this.parent.staticShadow&&(e=new THREE.Vector3(t.parent.xVerh,t.parent.yVerh,t.parent.zVerh),t.parent.sunLight.position.add(e),t.parent.sunLight.target.position.copy(e),r.distanceTo(e)>t.distanceUpdateShadow&&(r.copy(e),t.parent.shadowNeedsUpdate=!0)))))};var r=new THREE.Vector3;this.distanceUpdateShadow=500,this.dragSunLight2=function(){null!=this.parent.sunLight&&null!=this.parent.sunLight.parent&&(!0===this._fixation||(i=this._distance+2*this._cubHeight,this.parent.sunLight.position.set(0,i,0),this.parent.sunLight.position.applyAxisAngle(new THREE.Vector3(1,0,0),this._rotationX),this.parent.sunLight.position.applyAxisAngle(new THREE.Vector3(0,1,0),this._rotationZ)))},this.dragSunLight3=function(){this.parent.sunLight&&(this.parent.sunLight.shadow.camera.near=0+this._cubHeight,this.parent.sunLight.shadow.camera.far=2*this._cubHeight+this._cubHeight,this.parent.sunLight.shadow.camera.updateProjectionMatrix(),this.shadowHelper&&this.shadowHelper.update())},this.sunActiv=function(e){this.parent.objShadow(this.parent.group,e),1==e?null==this.parent.sunLight.parent&&(this.parent.scene.add(this.parent.sunLight),this.parent.scene.add(t.parent.sunLight.target)):null!=this.parent.sunLight.parent&&(this.parent.scene.remove(this.parent.sunLight),this.parent.scene.remove(t.parent.sunLight.target)),this.funDebug()},this.ambientActiv=function(e){1==e?null==this.parent.ambientLight.parent&&this.parent.scene.add(this.parent.ambientLight):null!=this.parent.ambientLight.parent&&this.parent.scene.remove(this.parent.ambientLight)}}n.prototype={set offset(e){this._offset=e||0},get offset(){return this._offset},set debug(e){this._debug=e,e&&!this.debugFocus&&(this.debugFocus=new r(this)),this.debugFocus&&(this.debugFocus.active=e)},get debug(){return this._debug},set active(e){this._active=e,e||(this.debug=!1)},get active(){return this._active}},s.prototype={set x(e){this._x!==e&&(this._x=e)},get x(){return this._x},set y(e){this._y!==e&&(this._y=e)},get y(){return this._y},set width(e){this._width!==e&&(this._width=e)},get width(){return this._width},set height(e){this._height!==e&&(this._height=e)},get height(){return this._height}},o.prototype={set x(e){this._x=e},get x(){return this._x},set y(e){this._y=e},get y(){return this._y},set z(e){this._z=e},get z(){return this._z}},i.d(t,"a",function(){return h}),h.prototype={set debug(e){this._debug!==e&&(this._debug=e,this.funDebug())},get debug(){return this._debug},set rotationX(e){this._rotationX!==e&&(this._rotationX=e,null!=this.spotLightHelper&&(this.parent.sunLight.shadow.camera.updateProjectionMatrix(),this.spotLightHelper.update()),this.dragSunLight2())},get rotationX(){return this._rotationX},set rotationZ(e){this._rotationZ!==e&&(this._rotationZ=e,this.sky.shadRotZ=e,null!=this.spotLightHelper&&this.spotLightHelper.update(),this.dragSunLight2())},get rotationZ(){return this._rotationZ},set fixation(e){this._fixation!==e&&(this._fixation=e,this.dragSunLight2())},get fixation(){return this._fixation},set distance(e){this._distance!==e&&(this._distance=e,this.dragSunLight3(),this.dragSunLight2())},get distance(){return this._distance},set cubHeight(e){this._cubHeight!==e&&(this._cubHeight=e,this.dragSunLight3(),this.dragSunLight2())},get cubHeight(){return this._cubHeight},set cubWidth(e){this._cubWidth!==e&&(this._cubWidth=e,this.parent.sunLight&&(this.parent.sunLight.shadow.camera.right=this._cubWidth,this.parent.sunLight.shadow.camera.left=-this._cubWidth,this.parent.sunLight.shadow.camera.top=this._cubWidth,this.parent.sunLight.shadow.camera.bottom=-this._cubWidth,this.parent.sunLight.shadow.camera.updateProjectionMatrix(),this.shadowHelper&&this.shadowHelper.update()))},get cubWidth(){return this._cubWidth}}},function(e,t,i){"use strict";i.d(t,"a",function(){return a});var A=i(0);function a(){var e,t=this;this.type="CubeMap",this.LINK="null",this.EXPOSURE=-1,this.GAMMA=-1,this._link="nullXZ",this._exposure=this.EXPOSURE,this._gamma=this.GAMMA,this.exposureStart=-1,this.gammaStart=-1,this._activDiz=!1,this._layer=1,this.otherLayer=31,this.renderer=void 0,this.scene=void 0,this.cubeCamera=new THREE.CubeCamera(1,1e4,512),this.geometry=new THREE.SphereBufferGeometry(1500,32,32),this.mesh=new THREE.Mesh(this.geometry),this.loader=void 0,this.loader=new A.a,this.init=function(e,t){void 0!==e&&void 0!==t&&(this.renderer=e,this.scene=t,this.scene.add(this.cubeCamera),this.scene.add(this.mesh),this.link="null")},this.setLayers=function(e){t.mesh.layers.set(e),t.cubeCamera.layers.set(e),t.cubeCamera.traverse(function(t){t.layers.set(e)})},this.upDate=function(e){this.setLayers(this.otherLayer),this.cubeCamera.update(e||this.renderer,this.scene),this.setLayers(this._layer)},this.material=void 0,this.dragMaterial=function(e){this.material=e,i==e.sahMin&&(this.mesh.material=e,this.upDate())},this.arrMat=[],this.testBD=function(e){for(var t=0;t<this.arrMat.length;t++)if(this.arrMat[t].linkMy==e)return this.arrMat[t];return null};var i=0;this.loadFun=function(){var A=++i,n=this._link+"";if(null!=(e=this.testBD(this._link))&&(e.sahMin=i,this.dragMaterial(e)),"null"!=this._link&&null!=this._link)-1==this._link.indexOf(".png")&&-1==this._link.indexOf(".jpg")&&-1==this._link.indexOf(".jpeg")?null!=this.loader?this.loader.load(this._link,function(e,i){var r=new THREE.ShaderMaterial({uniforms:{tDiffuse:{type:"t",value:e},exposure:{type:"f",value:i.exposure},gamma:{type:"f",value:i.gamma},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)}},vertexShader:a.vertex,fragmentShader:a.fragment});e.minFilter=THREE.LinearFilter,e.magFilter=THREE.NearestFilter,e.flipY=!0,e.wrapS=e.wrapT=THREE.RepeatWrapping,e.anisotropy=t.renderer.capabilities.getMaxAnisotropy(),r.side=THREE.BackSide,r.linkMy=n,r.sahMin=A,t.arrMat.push(r),t.dragMaterial(r),t.exposureStart=i.exposure,t.gammaStart=i.gamma,1==t._activDiz&&(t._exposure=i.exposure,t._gamma=i.gamma)}):console.log("Подключи в загрущик RGBELoader токо если надо hdr загрузить!!!"):(new THREE.TextureLoader).load(this._link,r);else{(new THREE.TextureLoader).load("data:image/jpeg;base64,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UmdzTWJvb2wAAAAAAENybkNib29sAAAAAABDbnRDYm9vbAAAAAAATGJsc2Jvb2wAAAAAAE5ndHZib29sAAAAAABFbWxEYm9vbAAAAAAASW50cmJvb2wAAAAAAEJja2dPYmpjAAAAAQAAAAAAAFJHQkMAAAADAAAAAFJkICBkb3ViQG/gAAAAAAAAAAAAR3JuIGRvdWJAb+AAAAAAAAAAAABCbCAgZG91YkBv4AAAAAAAAAAAAEJyZFRVbnRGI1JsdAAAAAAAAAAAAAAAAEJsZCBVbnRGI1JsdAAAAAAAAAAAAAAAAFJzbHRVbnRGI1B4bEBSAAAAAAAAAAAACnZlY3RvckRhdGFib29sAQAAAABQZ1BzZW51bQAAAABQZ1BzAAAAAFBnUEMAAAAATGVmdFVudEYjUmx0AAAAAAAAAAAAAAAAVG9wIFVudEYjUmx0AAAAAAAAAAAAAAAAU2NsIFVudEYjUHJjQFkAAAAAAAAAAAAQY3JvcFdoZW5QcmludGluZ2Jvb2wAAAAADmNyb3BSZWN0Qm90dG9tbG9uZwAAAAAAAAAMY3JvcFJlY3RMZWZ0bG9uZwAAAAAAAAANY3JvcFJlY3RSaWdodGxvbmcAAAAAAAAAC2Nyb3BSZWN0VG9wbG9uZwAAAAAAOEJJTQPtAAAAAAAQAEgAAAABAAIASAAAAAEAAjhCSU0EJgAAAAAADgAAAAAAAAAAAAA/gAAAOEJJTQQNAAAAAAAEAAAAeDhCSU0EGQAAAAAABAAAAB44QklNA/MAAAAAAAkAAAAAAAAAAAEAOEJJTScQAAAAAAAKAAEAAAAAAAAAAjhCSU0D9QAAAAAASAAvZmYAAQBsZmYABgAAAAAAAQAvZmYAAQChmZoABgAAAAAAAQAyAAAAAQBaAAAABgAAAAAAAQA1AAAAAQAtAAAABgAAAAAAAThCSU0D+AAAAAAAcAAA/////////////////////////////wPoAAAAAP////////////////////////////8D6AAAAAD/////////////////////////////A+gAAAAA/////////////////////////////wPoAAA4QklNBAAAAAAAAAIAQzhCSU0EAgAAAAAAiAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA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Lm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDE4LTEwLTA1VDE2OjMzOjQwKzAzOjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDE4LTEwLTA1VDE2OjMzOjQwKzAzOjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAxOC0xMC0wNVQxNjozMzo0MCswMzowMCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpBNDI1QjQxNkEzQzhFODExODIxNzhEQTQ1NUFCNTJGMCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpBMzI1QjQxNkEzQzhFODExODIxNzhEQTQ1NUFCNTJGMCIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOkEzMjVCNDE2QTNDOEU4MTE4MjE3OERBNDU1QUI1MkYwIiBkYzpmb3JtYXQ9ImltYWdlL2pwZWciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6QTMyNUI0MTZBM0M4RTgxMTgyMTc4REE0NTVBQjUyRjAiIHN0RXZ0OndoZW49IjIwMTgtMTAtMDVUMTY6MzM6NDArMDM6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDUzYgKFdpbmRvd3MpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpBNDI1QjQxNkEzQzhFODExODIxNzhEQTQ1NUFCNTJGMCIgc3RFdnQ6d2hlbj0iMjAxOC0xMC0wNVQxNjozMzo0MCswMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDw/eHBhY2tldCBlbmQ9InciPz7/4gxYSUNDX1BST0ZJTEUAAQEAAAxITGlubwIQAABtbnRyUkdCIFhZWiAHzgACAAkABgAxAABhY3NwTVNGVAAAAABJRUMgc1JHQgAAAAAAAAAAAAAAAQAA9tYAAQAAAADTLUhQICAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABFjcHJ0AAABUAAAADNkZXNjAAABhAAAAGx3dHB0AAAB8AAAABRia3B0AAACBAAAABRyWFlaAAACGAAAABRnWFlaAAACLAAAABRiWFlaAAACQAAAABRkbW5kAAACVAAAAHBkbWRkAAACxAAAAIh2dWVkAAADTAAAAIZ2aWV3AAAD1AAAACRsdW1p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",r)}function r(e){e.minFilter=THREE.LinearFilter,e.magFilter=THREE.NearestFilter,e.flipY=!0,e.wrapS=e.wrapT=THREE.RepeatWrapping,e.anisotropy=t.renderer.capabilities.getMaxAnisotropy();var i=new THREE.MeshBasicMaterial({map:e,side:THREE.BackSide});i.linkMy=n,i.sahMin=A,t.arrMat.push(i),t.dragMaterial(i)}},this.getTexture=function(){return this.cubeCamera.renderTarget.texture};var a={vertex:["uniform vec4 offsetRepeat;","varying vec2 vUv;","void main() {","    // vUv  = uv;","    vUv = uv * offsetRepeat.zw + offsetRepeat.xy;","    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 3);","}"].join("\n"),fragment:["uniform sampler2D   tDiffuse;","uniform float       exposure;","uniform float       gamma;","varying vec2  vUv;","vec3 decode_pnghdr( const in vec4 color ) {","    vec4 rgbcolor = vec4( 0.0, 0.0, 0.0, 0.0 );","    if ( color.w > 0.0 ) {","        float f = pow(2.0, 127.0*(color.w-0.5));","        rgbcolor.xyz = color.xyz * f;","    }","    return rgbcolor.xyz;","    /*","    // remove gamma correction","    vec4 res = color * color;","    // decoded RI","    float ri = pow( 2.0, res.w * 32.0 - 16.0 );","    // decoded HDR pixel","    res.xyz = res.xyz * ri;","    return res.xyz;","    */","}","void main() {","    vec4 color = texture2D( tDiffuse, vUv );","    color.xyz  = decode_pnghdr( color );","    // apply gamma correction and exposure","    //gl_FragColor = vec4( pow( exposure * color.xyz, vec3( 0.474 ) ), 1.0 );","    // Perform tone-mapping","    float Y = dot(vec4(0.30, 0.59, 0.11, 0.0), color);","    float YD = exposure * (exposure/gamma + 1.0) / (exposure + 1.0);","    color *= YD;","    gl_FragColor = vec4( color.xyz, 1.0 );","}"].join("\n")};this.debug=!1}Object.defineProperties(a.prototype,{link:{set:function(e){this._link!=e&&(this._link=e,this.loadFun())},get:function(){return this._link}},activDiz:{set:function(e){this._activDiz!=e&&(this._activDiz=e)},get:function(){return this._activDiz}},exposure:{set:function(e){this._exposure!=e&&(this._exposure=e,this.material&&null!=this.material.uniforms&&(this.material.uniforms.exposure.value=e,this.upDate()))},get:function(){return this._exposure}},gamma:{set:function(e){this._gamma!=e&&(this._gamma=e,this.material&&null!=this.material.uniforms&&(this.material.uniforms.gamma.value=e,this.upDate()))},get:function(){return this._gamma}},debug:{set:function(e){this._debug!=e&&(this._debug=e,this._layer=e?0:31,this.setLayers(this._layer))},get:function(){return this._debug}}})},function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(e){"object"==typeof window&&(i=window)}e.exports=i},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return MVisi3D});var _MEffectArray_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(12),_MPosition3d_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(8),_MEvent3DArr_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(13),_MUtility_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(4),_CubeMap_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(5);function MVisi3D(_contentHTML,_content2d,_devas,_directional,_efect,_event3DArr,_alpha){var self=this;_devas=void 0!==_devas&&_devas,_directional=void 0===_directional||_directional,_efect=void 0===_efect||_efect,_event3DArr=void 0===_event3DArr||_event3DArr,_alpha=void 0!==_alpha&&_alpha,this.intRend=0,this.devas=_devas,this.alpha=_alpha,this.arrSetiScene=[],this._xVerh=0,this._yVerh=0,this._zVerh=0,this._rotationX=0,this._rotationZ=0,this._zume=1e3,this._arrOut=[],this._x=0,this._y=0,this._height=100,this._width=100,this.yes3d=!0,this.intRendOk=1,this._visible=!0,this._isDragPan=!1,this._activMouse=!0,this._staticShadow=!1,this._fov=45,this.alwaysRender=!1,this.AMBIEN_COLOR="#ffffff",this.AMBIEN_INTENSITY=.79,this.LIGHT_COLOR="#ffffff",this.LIGHT_BIAS=.001,this.SHADOW_INTENSITY=.22,this.SHADOW_RADIUS=1,this.SHADOW_WH=4096,this.DISTANCE=0,this.CUB_HEIGHT=500,this.CUB_WIDTH=500,this.FOV=45,this.FAR=45e3,this._fov=this.FOV,this.content=void 0,this.graphics=void 0,null!=_content2d&&(this.content=eval("new PIXI.Container()"),this.graphics=eval("new PIXI.Graphics()"),_content2d.addChild(this.content),this.content.addChild(this.graphics),this.graphics.interactive=!0),this.camera,this.scene=new THREE.Scene;var color=16777215;this.color=color,this.camera=new THREE.PerspectiveCamera(this.FOV,this._width/this._height,1,this.FAR),this.renderer=new THREE.WebGLRenderer({antialias:!0,alpha:_alpha}),this.renderer.shadowMap.enabled=!0,this.renderer.setSize(this._width,this._height),1==_alpha?this.renderer.setClearColor(color,0):this.renderer.setClearColor(color,1),this.renderer.shadowMap.type=THREE.PCFSoftShadowMap,this.efect,this.efect=new _MEffectArray_js__WEBPACK_IMPORTED_MODULE_0__.a(this),_contentHTML.appendChild(this.renderer.domElement),this.event3DArr,1==_event3DArr&&(this.event3DArr=new _MEvent3DArr_js__WEBPACK_IMPORTED_MODULE_2__.a(this,this.camera,this.renderer.domElement),this.scene.event3DArr=this.event3DArr,this.event3DArr.addDragEvent(this.graphics,this.renderer.domElement),this.event3DArr.activ=this._activMouse),this.camera.position.set(0,0,-60),this.camera.rotation.set(Math.PI,0,0),this.renderer.domElement.style.position="fixed",this.renderer.domElement.style.top="0px",this.renderer.domElement.style.left="0px",this.group=new THREE.Object3D,this.group.rotation.x=Math.PI/2,this.scene.add(this.group),this.group1=new THREE.Object3D,this.group.add(this.group1),this.group2=new THREE.Object3D,this.group1.add(this.group2),this.groupObject=new THREE.Object3D,this.group2.add(this.groupObject),this.group3d=new THREE.Object3D,this.groupObject.add(this.group3d),this.gCGG=new THREE.Object3D,this.group.add(this.gCGG),this.gCAngel=new THREE.Object3D,this.gCGG.add(this.gCAngel),this.gCam1=new THREE.Object3D,this.gCAngel.add(this.gCam1),this.gCam2=new THREE.Object3D,this.gCam1.add(this.gCam2),this.ggCam=new THREE.Object3D,this.gCam2.add(this.ggCam),this.ggCam.add(this.camera),this.ggCam.position.z=-this._zume,this.camera.position.z=0,this.axesHelper=new THREE.AxesHelper(100),this.scene.add(this.axesHelper),this.axesHelper.visible=!1,this.arrPoint=[];var disLig=4e3,powerLig=.4,dis=1e4,bbbbbb;if(this.sunLight,this.ambientLight=new THREE.AmbientLight(this.AMBIEN_COLOR,this.AMBIEN_INTENSITY),this.scene.add(this.ambientLight),this.ambientLight.castShadow=!1,1==_directional){var sunIntensity=this.SHADOW_INTENSITY;this.sunLight=new THREE.DirectionalLight(this.LIGHT_COLOR,sunIntensity,0,0,.2),this.sunLight.position.set(0,this.DISTANCE+2*this.CUB_HEIGHT,0),this.sunLight.castShadow=!0,this.sunLight.shadow.camera.near=this.CUB_HEIGHT,this.sunLight.shadow.camera.far=this.CUB_HEIGHT+2*this.CUB_HEIGHT,this.sunLight.shadow.camera.right=this.CUB_WIDTH,this.sunLight.shadow.camera.left=-this.CUB_WIDTH,this.sunLight.shadow.camera.top=this.CUB_WIDTH,this.sunLight.shadow.camera.bottom=-this.CUB_WIDTH,this.sunLight.shadow.mapSize.width=this.SHADOW_WH,this.sunLight.shadow.mapSize.height=this.SHADOW_WH,this.sunLight.shadow.bias=this.LIGHT_BIAS,this.sunLight.shadow.radius=this.SHADOW_RADIUS}this.initOut=function(){},this.position3d=new _MPosition3d_js__WEBPACK_IMPORTED_MODULE_1__.a(self,this.graphics,this.renderer.domElement),this.utility=new _MUtility_js__WEBPACK_IMPORTED_MODULE_3__.a(self),this.arrayDoRender=[],this.arrayDoRender2=[],this.shadowNeedsUpdate=!1,this.render=function(){if(0!=this.yes3d){if(0!=this.arrayDoRender2.length)for(var e=0;e<this.arrayDoRender2.length;e++)this.arrayDoRender2[e]();if(this.utility.render(),this.intRend=10,this.shadowNeedsUpdate&&(this.shadowNeedsUpdate=!1,this.renderer.shadowMap.needsUpdate=!0),this.efect?0==this.efect.render()&&this.renderer.render(this.scene,this.camera):this.renderer.render(this.scene,this.camera),0!=this.arrayDoRender.length)for(e=0;e<this.arrayDoRender.length;e++)this.arrayDoRender[e]()}},this.upDate=function(){(this.alwaysRender||this.intRend==this.intRendOk)&&this.render(),this.intRend<10&&this.intRend++},this.renderer.render(this.scene,this.camera),this.sizeWindow=function(e,t,i,A){null!=e&&(this._x=e),null!=t&&(this._y=t),null!=A&&(this._height=A),null!=i&&(this._width=i),null!=this.content&&(this.content.x=this._x,this.content.y=this._y,this.graphics.clear(),this.graphics.beginFill(16711680,0),this.graphics.drawRect(0,0,this._width,this._height),this.graphics.endFill()),this.renderer.domElement.style.left=this._x+"px",this.renderer.domElement.style.top=this._y+"px",this.camera.aspect=this._width/this._height,this.camera.updateProjectionMatrix(),this.renderer.setSize(this._width,this._height),this.intRend=1,this.event3DArr&&(this.event3DArr.sizeWindow(this._width,this._height),this.event3DArr.setRect(this._x,this._y,this._width,this._height)),this.efect&&this.efect.sizeWindow(this._width,this._height)},this.render(),this.sizeWindow(),this.objShadow=function(e,t){if(null==t&&(t=!0),bbbbbb=!0,e.material&&1==e.material.transparent&&e.material.opacity<1&&(bbbbbb=!1),1==bbbbbb&&(e.castShadow=t,e.receiveShadow=t),null!=e.children)for(var i=0;i<e.children.length;i++)null!=e.children?this.objShadow(e.children[i],t):(bbbbbb=!0,e.children[i].material&&1==e.material.transparent&&e.material.opacity<1&&(bbbbbb=!1),1==bbbbbb&&(e.children[i].castShadow=t,e.children[i].receiveShadow=t))},this.cubeMap=new _CubeMap_js__WEBPACK_IMPORTED_MODULE_4__.a,this.cubeMap.init(this.renderer,this.scene),this.getEnvMap=function(){return self.cubeMap.getTexture()},this.cubeMap1=new _CubeMap_js__WEBPACK_IMPORTED_MODULE_4__.a,this.cubeMap1.init(this.renderer,this.scene);var t=this.cubeMap1.getTexture();t.mapping=THREE.CubeRefractionMapping,this.cubeMap1.upDate(),this.getEnvMap1=function(){return self.cubeMap1.getTexture()},this.getObj=function(){var e={};return e.xVerh=this._xVerh,e.yVerh=this._yVerh,e.zVerh=this._zVerh,e.rotationX=this._rotationX,e.rotationZ=this._rotationZ,e.zume=this._zume,e},this.setObj=function(e){null!=e&&(this.xVerh=e.xVerh,this.yVerh=e.yVerh,this.zVerh=e.zVerh,this.rotationX=e.rotationX,this.rotationZ=e.rotationZ,this.zume=e.zume)},this.mousemove=function(e){self.position3d.stageMoveNew(e),self.event3DArr.mousemove(e)},this.getFunMouseMove=function(){return 0==self.devas?self.position3d.div.removeEventListener("mousemove",self.mousemove):self.position3d.div.removeEventListener("touchmove",self.mousemove),self.mousemove},0==self.devas?self.position3d.div.addEventListener("mousemove",self.mousemove):self.position3d.div.addEventListener("touchmove",self.mousemove),document.oncontextmenu=function(e){return!1},this.addEvent=function(e,t){this.event3DArr&&this.event3DArr.eventSob.addEvent(e,t)},this.removeEvent=function(e,t){this.event3DArr&&this.event3DArr.eventSob.removeEvent(e,t)},this.addChildMouse=function(e){this.event3DArr&&this.event3DArr.addChild(e)},this.removeChildMouse=function(e){this.event3DArr&&this.event3DArr.removeChild(e)},this.fun_rotationX,this.fun_rotationZ}MVisi3D.prototype={set staticShadow(e){this.renderer.shadowMap.autoUpdate=!e,this._staticShadow=e},get staticShadow(){return this._staticShadow},set rotationX(e){this._rotationX!==e&&(this._rotationX=e,this.intRend=1,this.gCam2.rotation.x=e,this.fun_rotationX&&this.fun_rotationX())},get rotationX(){return this._rotationX},set rotationZ(e){this._rotationZ!==e&&(this._rotationZ=e,this.gCam1.rotation.z=e,this.intRend=1,this.fun_rotationZ&&this.fun_rotationZ())},get rotationZ(){return this._rotationZ},set zume(e){this._zume!==e&&(this._zume=e,this.ggCam.position.z=-e,this.camera.position.z=0,this.intRend=1)},get zume(){return this._zume},set fov(e){this._fov=e,this.camera.fov=e,this.camera.updateProjectionMatrix()},get fov(){return this._fov},set yVerh(e){this._yVerh=e,this.gCGG.position.z=e,this.intRend=1},get yVerh(){return this.gCGG.position.z},set xVerh(e){this._xVerh=e,this.gCGG.position.x=e,this.intRend=1},get xVerh(){return this.gCGG.position.x},set zVerh(e){this._zVerh=e,this.gCGG.position.y=e,this.intRend=1},get zVerh(){return this.gCGG.position.y},set arrOut(e){this._arrOut=e,1!=this.alpha&&(this.efect&&this.efect.setValue(this._arrOut),this.intRend=1)},get arrOut(){return this._arrOut},set x(e){this._x=e,this.sizeWindow()},get x(){return this._x},set y(e){this._y=e,this.sizeWindow()},get y(){return this._y},set height(e){this._height=e,this.sizeWindow()},get height(){return this._height},set width(e){this._width=e,this.sizeWindow()},get width(){return this._width},set visible(e){this._visible=e,this.content.visible=e,this.renderer.domElement.style.visibility=e?"visible":"hidden"},get visible(){return this._visible},set isDragPan(e){this._isDragPan=e,this.position3d.isDragPan=e},get isDragPan(){return this._isDragPan},set activMouse(e){this._activMouse=e,this.event3DArr&&(this.event3DArr.activ=this._activMouse)},get activMouse(){return this._activMouse},set minZum(e){this.position3d.minZum=e},get minZum(){return this.position3d.minZum},set maxZum(e){this.position3d.maxZum=e},get maxZum(){return this.position3d.maxZum},set maxRotationX(e){this.position3d.minMaxX.x=e},get maxRotationX(){return this.position3d.minMaxX.x},set minRotationX(e){e<this.rotationX&&(this.rotationX=e),this.position3d.minMaxX.y=e},get minRotationX(){return this.position3d.minMaxX.y}}},function(e,t,i){"use strict";i.d(t,"a",function(){return A});i(4),i(2),i(3);function A(e,t,i){var A=this;this.parent=e,this.content2d=t,this.drag=!0,this.zdvigX=0,this.sPixi=void 0,this.div=i,this.devas=e.devas,this.pause=!1,this.minMaxX=new THREE.Vector2(0,2.5),this.zume=new THREE.Vector3(1,30,10),this.point=new THREE.Vector2(0,0),this.point1=new THREE.Vector2(0,0),this.b=0,this.minZum=0,this.maxZum=5e3,this.powerZum=50,this.distMinMaxBox=1500,this.boolDrahXZ=!0,this.isDragPan=e._isDragPan,this.isRotateScene=!1;var a=0;this.isIE=!1,(-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>0)&&(this.isIE=!0),this.getStage=function(e){return null==e.parent?e:this.getStage(e.parent)},this.stageMoveNew=function(e){0!=A.boolDrag&&1!=A.pause&&0!=A.drag&&(e&&A.isDragPan&&o?c(e):null==e.touches?A.isRotateScene&&e.data.originalEvent.shiftKey?(A.parent.scene.rotation.y=a+.01*(e.clientX-A.point1.x),A.parent.intRend=1):A.boolDrahXZ&&(A.parent.rotationX=A.point.y-.01*(e.clientY-A.point1.y),A.minMaxX.x>A.parent.rotationX&&(A.parent.rotationX=A.minMaxX.x),A.minMaxX.y<A.parent.rotationX&&(A.parent.rotationX=A.minMaxX.y),A.parent.rotationZ=A.point.x+.01*(e.clientX-A.point1.x)):1==e.touches.length?A.boolDrahXZ&&(A.parent.rotationX=A.point.y-.01*(e.touches[0].clientY-A.point1.y),A.minMaxX.x>A.parent.rotationX&&(A.parent.rotationX=A.minMaxX.x),A.minMaxX.y<A.parent.rotationX&&(A.parent.rotationX=A.minMaxX.y),A.parent.rotationZ=A.point.x+.01*(e.touches[0].clientX-A.point1.x)):e.touches.length>=2&&(A.pT.x=e.touches[0].clientX,A.pT.y=e.touches[0].clientY,A.pT1.x=e.touches[1].clientX,A.pT1.y=e.touches[1].clientY,0==A.distTach?(A.distTach=calc.getDistance(A.pT,A.pT1),n=0,l.set(Math.round(1*A.pT.x),Math.round(1*A.pT.y))):(r=calc.getDistance(A.pT,A.pT1),n=r-A.distTach,A.distTach=r),s=A.parent._zume-n*(A.parent._zume/100),A.zumNEW(s),c(null,Math.round(1*A.pT.x),Math.round(1*A.pT.y))))},this.pT=new THREE.Vector2(0,0),this.pT1=new THREE.Vector2(0,0);var n=0,r=0;this.boolDrag=!1,this.stageUpNew=function(e){A.boolDrag=!1,0==A.devas?window.removeEventListener("mouseup",A.stageUpNew):(A.distTach=0,window.removeEventListener("touchend",A.stageUpNew))},this.mouseUpp=function(e){A.parent.intRend=1};var s,o=!1;if(this.distTach=0,this.mouseDown=function(e){var t;1!=A.pause&&(0!=A.drag&&(o=!1,A.boolDrag=!0,A.distTach=0,A.point.y=A.parent.rotationX,A.point.x=A.parent.rotationZ,A.isRotateScene&&(a=A.parent.scene.rotation.y),A.isDragPan&&e&&1===e.button&&(o=!0,t=e,l.set(t.clientX,t.clientY)),0==A.devas?(A.point1.x=e.clientX,A.point1.y=e.clientY,window.addEventListener("mouseup",A.stageUpNew)):(A.point1.x=e.touches[0].clientX,A.point1.y=e.touches[0].clientY,window.addEventListener("touchend",A.stageUpNew))))},this.dragscrol=void 0,this.mousewheel=function(e){if(0!=A.drag){var t=-1;e.delta;null==e.wheelDelta&&e.wheelDelta,e.delta&&e.delta<0&&(t=1),e.deltaY&&e.deltaY<0&&(t=1),e.detail&&e.detail<0&&(t=1),null!=e.wheelDelta&&(t=e.wheelDelta>0?-1:1),s=A.parent._zume+t*(A.powerZum/100)*A.parent._zume,A.zumNEW(s),A.dragscrol&&A.dragscrol(e)}},this.zumNEW=function(e){e<A.minZum&&(e=A.minZum),e>A.maxZum&&(e=A.maxZum),A.parent.zume=e,A.parent.intRend=1},0==A.devas){i.addEventListener("mousedown",this.mouseDown);i.addEventListener("mousewheel",this.mousewheel),i.addEventListener("DOMMouseScroll",this.mousewheel),trace("dsfasf###########","mousewheel")}else i.addEventListener("touchstart",this.mouseDown,{passive:!1,capture:!0});trace("dsfasfasdfasdfasf");var h=new THREE.Vector3,l=new THREE.Vector2,d=new THREE.Vector2,u=new THREE.Vector2;function c(e,t,i){null!=e?d.set(e.clientX,e.clientY):d.set(t,i),u.subVectors(d,l),A.moveCamXY(u),l.copy(d)}var f=function(){var e=new THREE.Vector3;return function(t,i){e.setFromMatrixColumn(i,0),e.multiplyScalar(-t),h.add(e)}}(),g=function(){var e=new THREE.Vector3;return function(t,i){e.setFromMatrixColumn(i,1),e.multiplyScalar(t),h.add(e)}}(),p=function(e,t){var i=A.parent.renderer.domElement;if(A.parent.camera.isPerspectiveCamera){var a=Math.max(A.parent.zume,10);a*=Math.tan(A.parent.camera.fov/2*Math.PI/180),f(2*e*a/i.clientHeight,A.parent.camera.matrixWorld),g(2*t*a/i.clientHeight,A.parent.camera.matrixWorld)}else console.warn("WARNING: camera neither perspective.")};this.moveCamXY=function(e){h.set(0,0,0),A.parent.camera.updateMatrixWorld(),A.parent.scene.updateMatrixWorld(),arguments.length>1&&(e={x:arguments[0],y:arguments[1]}),p(e.x||0,e.y||0),A.parent.xVerh+=h.x,A.parent.yVerh+=-h.y,A.parent.zVerh+=h.z,A.parent.xVerh=Math.max(Math.min(A.parent.xVerh,A.distMinMaxBox),-A.distMinMaxBox),A.parent.zVerh=Math.max(Math.min(A.parent.zVerh,A.distMinMaxBox),-A.distMinMaxBox),A.parent.yVerh=Math.max(Math.min(A.parent.yVerh,A.distMinMaxBox),-A.distMinMaxBox),h.set(0,0,0)}}},function(module,__webpack_exports__,__webpack_require__){"use strict";function PMMat(par,visi3D,objbase){this.type="PMMat";var self=this;this.par=par,this.visi3D=visi3D,this.objbase=objbase,this.pmTexture=this.par.tex,this.ser=window.location.href;var arrParams=window.location.href.split("?"),arrParams2=arrParams[0].split("/");this.server="";for(var i=0;i<arrParams2.length-1;i++)this.server+=arrParams2[i]+"/";this.setObjS=function(e,t,i){this.getTestTitleObj(e),i()},this.testObjMatLoad=function(e){if(e.children)for(var t=0;t<e.children.length;t++)if(0==this.testObjMatLoad(e.children[t]))return!1;return!e.material||null==e.material.bLoad||0!=e.material.bLoad},this.matarialArray=this.objbase.materials;var matarialArray=this.matarialArray;this.idColor=null;var loader=new THREE.TextureLoader,rt,textur;this.obj={},this.getTestTitle=function(e){var t=null;if(null!=e)for(var i=0;i<matarialArray.length;i++)if(-1!=e.indexOf(matarialArray[i].title))return t=this.getIDReturn(matarialArray[i].id);return t},this.getTestTitleObj=function(e){e.material&&null!=(rt=this.getTestTitle(e.material.name))&&(e.material=rt);for(var t=0;t<e.children.length;t++)this.getTestTitleObj(e.children[t])},this.getIDReturn=function(id,isBD){for(var r=null,p=-1,i=0;i<matarialArray.length;i++)matarialArray[i].id==id&&(p=i);if(-1==p)return null;if(null==isBD&&null!=this.obj[id])return this.obj[id];var comand="new THREE."+matarialArray[p].key+"()",m=eval(comand);return m.idObj=matarialArray[p],this.startMat(m,id),this.obj[id]=m,m.idUz=id,m},this.get=function(e,t,i){var A,a,n=-1;if(null!=i){A=e+"",e="2456567567867896789";for(var r=0;r<this.matarialArray.length;r++)if(a=this.matarialArray[r].title+"",-1!=A.indexOf(a)){e=this.matarialArray[r].title;break}}for(r=0;r<this.matarialArray.length;r++)this.matarialArray[r].title==e&&(n=r);-1!=n?this.getId(this.matarialArray[n].id,t):t(null)},this.getId=function(id,_fun){for(var p=-1,i=0;i<this.matarialArray.length;i++)if(this.matarialArray[i].id==id){p=i;break}if(-1!=p){if(null!=this.obj[id])return 1==this.obj[id].bLoad?_fun(this.obj[id]):this.obj[id].arrFun.push(_fun),this.obj[id];var comand="new THREE."+this.matarialArray[p].key+"()",m=eval(comand);return m.idObj=matarialArray[p],m.bLoad=!1,m.loadTexure=999,m.arrFun=[_fun],this.startMat(m,id),this.obj[id]=m,m}_fun(null)},this.objToMater=function(e,t){var i=this;for(var A in e)null!=t[A]&&(t[A]instanceof THREE.Color?t[A]=new THREE.Color(e[A]):t[A]=e[A]);if(t.loadTexure=0,e.textur){t.loadTexure=e.textur.length;for(var a=0;a<e.textur.length;a++)e.textur[a].id?function(){var A=a;textur=i.pmTexture.getById(e.textur[a].id,function(i){t[e.textur[A].name]=i,--t.loadTexure}),t[e.textur[a].name]=textur}():((textur=loader.load(e.textur[a].link,function(){self.visi3D&&(self.visi3D.intRend=1),t.loadTexure--})).wrapS=textur.wrapT=THREE.RepeatWrapping,textur.repeat.x=e.textur[a].rx,textur.repeat.y=e.textur[a].ry,t[e.textur[a].name]=textur)}if(t.needsUpdate=!0,t.bLoad=!0,t.arrFun)for(a=0;a<t.arrFun.length;a++)t.arrFun[a](t)},this.startMat=function(e,t){var i,A=this.server+"resources/data/"+t+"/config.json"+self.par.plus;$.ajax({url:A,success:function(t){if("string"==typeof t){var A=JSON.parse(t);i=A}else i=t;!0===i.mirro?self.visi3D&&(e.envMap=self.visi3D.getEnvMap()):(i.mirro,1==i.mirro&&self.visi3D&&(e.envMap=self.visi3D.getEnvMap()),2==i.mirro&&self.visi3D&&(e.envMap=self.visi3D.getEnvMap1())),self.objToMater(i.obj,e)},error:function(e){self.start()}})}}__webpack_require__.d(__webpack_exports__,"a",function(){return PMMat})},function(e,t,i){"use strict";function A(e,t){this.fun=e;var i,A=this;this.object,this.key=t||"shirt",this.object,this.initLoad=function(){i=!0,this.object=window.localStorage[this.key],"undefined"==this.object&&(i=!1),null==this.object&&(i=!1),this.object=0==i?this.getStartObj():jQuery.parseJSON(this.object),this.fun&&setTimeout(function(){A.fun()},1)},this.getStartObj=function(){return{activ:!1,dubag:!1,menu:{},xz:{}}},this.save=function(){window.localStorage[this.key]=JSON.stringify(A.object)},this.clear=function(){window.localStorage[this.key]=void 0},A.initLoad()}i.d(t,"a",function(){return A})},function(e,t,i){"use strict";function A(e,t){for(var i=0;i<t.length;i++){var A=t[i];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(e,A.key,A)}}var a=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type="MOBaza",this.typeNa="xz";this.par=t,this.fun=i,this._active=!1,this.otstup=this.par.otstup,this.otstup1=this.par.otstup1,this.wh=this.par.wh,this.width=this.par.width,this.whSize=this.par.whSize,this.dCont=new DCont(t.dCont),this.dCont.visible=this._active,this.object=void 0,this.postSO=void 0,this.postIn=void 0,this.init=function(){null==this.window&&(this.whSize=this.par.whSize,this.window=new DWindow(this.dCont,0,0,"xz"),this.window.width=this.width,this.window.hasMinimizeButton=!1,this.window.dragBool=!1,null!=this.postIn&&this.postIn())},this.setObject=function(e){this.object=e,this.active=!0,this.init(),null!=this.postSO&&this.postSO()},this.drag=function(){},this.clear=function(){this.active=!1}}var t,i,a;return t=e,(i=[{key:"active",set:function(e){this._active!=e&&(this._active=e,this.dCont.visible=e)},get:function(){return this._active}}])&&A(t.prototype,i),a&&A(t,a),e}();function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var i=0;i<t.length;i++){var A=t[i];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(e,A.key,A)}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var l=function(e){function t(e,i){var A;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(A=function(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?h(e):t}(this,s(t).call(this,e,i))).type="PSetings";var a=h(h(A));A._index=-1,A.dCont=new DCont(e.dCont),A.window=new DWindow(A.dCont,10,10,"Setings",function(){}),A.window.width=300;A.otstup;A.array=[];var r=[];function o(){0==this.idArr&&a.fun("index",this._index),1==this.idArr&&a.fun("index1",this._index)}for(var l=(A.window.width-4*A.otstup)/3,d=0;d<2;d++)r[d]=new DGallery(A.window.content,A.otstup,A.otstup,o),r[d].kolII=3,r[d].widthPic=r[d].heightPic=l,r[d].idArr=d,r[d].width=A.window.width-2*A.otstup;for(var u=0;u<mainBig.objectBase.three.length;u++)if(mainBig.objectBase.three[u].keyName&&"objArr"==mainBig.objectBase.three[u].keyName){var c=mainBig.objectBase.three[u].array;for(d=0;d<c.length;d++)c[d].title=" ",c[d].src="resources/data/"+c[d].id+"/256.png";r[0].start(c),r[0].height=2*(2+r[0].heightPic)+3}return A.arrGal=r,A.window.height=32+r[0].height+8,trace("objectBase",mainBig.objectBase),A.dragGal=function(e){if(-1==e)r[0].index=-1,r[1].visible=!1,this.window.height=32+r[0].height+8;else{r[1].visible=!0,r[1].y=r[0].height+r[0].y+4;for(var t=r[0].array[e].object.array,i=0;i<t.length;i++)t[i].title=" ",t[i].src="resources/data/"+t[i].id+"/256.png";r[1].start(t),r[1].height=Math.ceil(t.length/3)*(2+r[1].heightPic)+3,r[1].index=-1,this.window.height=32+r[1].height+r[1].y+6,trace(e,r[0].array[e].object)}},A.dragGal(-1),A.sizeWindow=function(e,t,i){e&&(e,t,i)},A}var i,A,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(t,a),i=t,(A=[{key:"index",set:function(e){this._index!=e&&(this._index=e,this.arrGal[0].index=e,null==this.arrGal[0].array[e]?this.dragGal(-1):this.dragGal(e))},get:function(){return this._index}}])&&r(i.prototype,A),l&&r(i,l),t}();function d(e,t){for(var i=0;i<t.length;i++){var A=t[i];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(e,A.key,A)}}var u=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type="Menu";var A=this;this.par=t,this.fun=i,this._index=-1,this._id=-1,this.debug=t.debug,this.otstup=4,this.otstup1=10,this.wh=100,this._indexSah=-1,this.array=[],this.dCont=new DCont(t.dCont),this.array[this.array.length]=this.pSetings=new l(this,function(e,t){A.fun(e,t)}),this.sizeWindow=function(e,t,i){for(var A=0;A<this.array.length;A++)this.array[A]&&this.array[A].sizeWindow&&this.array[A].sizeWindow(e,t,i)},this.setObj=function(e){}}var t,i,A;return t=e,(i=[{key:"index",set:function(e){this._index!=e&&(this._index=e,this.pSetings.index=e)},get:function(){return this._index}}])&&d(t.prototype,i),A&&d(t,A),e}();function c(e,t){for(var i=0;i<t.length;i++){var A=t[i];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(e,A.key,A)}}var f=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type="Backpack";var A=this;this.par=t,this.fun=i,this.content3d=new THREE.Object3D,this.par.content3d.add(this.content3d),this._index=-1,this.at=[],this.atan=[];for(var a=0;a<mainBig.objectBase.three.length;a++)mainBig.objectBase.three[a].keyName&&"objArr"==mainBig.objectBase.three[a].keyName&&(this.at=mainBig.objectBase.three[a].array);for(var n=0;n<this.at.length;n++)this.atan[n]=this.at[n].keyName.split(",");this.matNaC3d=function(e,t){if(e.material){var i=A.par.pm.mat.getIDReturn(t);e.material=i}},this.creatMat=function(e){for(var t=0;t<e.children.length;t++)for(var i=0;i<A.atan.length;i++)-1!=A.atan[i].indexOf(e.children[t].name)&&this.matNaC3d(e.children[t],A.at[i].array[0].id)},this.c3d,this.par.pm.getId(15,function(e){A.c3d=e,A.content3d.add(e),A.par.visi3D.intRend=1,A.par.visi3D.addChildMouse(e),A.creatMat(e)}),this.testIndex=function(e){for(var t=0;t<A.atan.length;t++)if(-1!=A.atan[t].indexOf(e))return t;return-1},this.redrag1=function(e){for(var t=0;t<A.c3d.children.length;t++)-1!=A.atan[this._index].indexOf(A.c3d.children[t].name)&&this.matNaC3d(A.c3d.children[t],A.at[this._index].array[e].id)},this.sten,this.pointZdvig=new THREE.Vector3(0,0,0),this.move=function(e){},this.out=function(e){e&&e.target,window.document.body.style.cursor="auto"},this.over=function(e){e&&e.target&&(-1!=A.testIndex(e.target.name)&&(window.document.body.style.cursor="pointer"))};this.down=function(e){if(e&&e.target){var t=A.testIndex(e.target.name);if(-1!=t)return void A.fun("index",t)}-1!=A._index&&A.fun("index",-1)},this.par.visi3D.addEvent("out",this.out),this.par.visi3D.addEvent("over",this.over),this.par.visi3D.addEvent("down",this.down)}var t,i,A;return t=e,(i=[{key:"index",set:function(e){this._index!=e&&(this._index=e)},get:function(){return this._index}}])&&c(t.prototype,i),A&&c(t,A),e}(),g=i(7);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e){this.type="SceneSB",this.visi3D=e;this.array=[],this.object=void 0,this.array.push(new I("ambient",e)),this.array.push(new v("shadow",e)),this.array.push(new C("sky",e)),this.array.push(new y("mirror",e)),this.array.push(new b("visi3D",e)),this.array.push(new T("effect",e)),this.array.push(new _("fog",e)),this.setObj=function(e){this.object=e;for(var t=0;t<this.array.length;t++)void 0===this.object[this.array[t].name]&&(this.object[this.array[t].name]={}),this.array[t].setBasa(this.object[this.array[t].name]);visi3D.shadowNeedsUpdate=!0}}function x(e,t){this.type="SceneBox";this.name=e,this.array=[],this.object=null,this.objArray={},this.plus=function(e,t){this.array.push(new E(e,t)),this.objArray[e.param]=this.array[this.array.length-1]},this.setValue=function(e,t,i){null==i?this.object[e]=t:this.drahKeyParam(e,t)},this.drahKey=function(e){null==this.objArray.works||0!=this.object.works?(null!=this.objArray[e]&&(1==this.objArray[e].tipP&&("object"===p(this.objArray[e].param[e])?this.objArray[e].param[e]=this.object[e]:this.objArray[e].param[e]!=this.object[e]&&(this.objArray[e].param[e]=this.object[e])),2==this.objArray[e].tipP&&this.objArray[e].param(this.object[e])),t.intRend=1):"active"==e&&this.objArray.active.param&&(this.objArray.active.param(this.object.active),t.intRend=1)},this.drahKeyParam=function(e,i){null!=this.objArray[e]&&(1==this.objArray[e].tipP&&("object"===p(this.objArray[e].param[e])?this.objArray[e].param[e]=i:this.objArray[e].param[e]!=i&&(this.objArray[e].param[e]=i)),2==this.objArray[e].tipP&&this.objArray[e].param(i)),t.intRend=1},this.setBasa=function(e){this.object=e;for(var t=0;t<this.array.length;t++)null==e[this.array[t].object.param]&&(e[this.array[t].object.param]=this.array[t].object.valueStart);this.drahKeys()},this.drahKeys=function(){for(var e=0;e<this.array.length;e++)this.drahKey(this.array[e].object.param)},this.plus({name:"check10",typeParam:"DCheckBox",param:"works",title:"works//false не работает",valueStart:!0})}function E(e,t){this.type="SceneGron";this.object=e,this.param=t,this.tipP=0,null!=t&&("object"===p(t)&&(this.tipP=1),"function"==typeof t&&(this.tipP=2))}function v(e,t){x.call(this,e,t),this.type="SceneBox1";this.plus({name:"check",typeParam:"DCheckBox",param:"active",title:"active",valueStart:!1},function(e){t.utility.sunActiv(e)}),this.plus({name:"slider10",typeParam:"DSliderBig",param:"mapSize",title:"mapSize",min:64,max:8192,value:2048,okrug:1,valueStart:t.SHADOW_WH},function(e){e=e||t.SHADOW_WH,t.sunLight.shadow.mapSize.width!=e&&(t.sunLight.shadow.mapSize.width=e,t.sunLight.shadow.mapSize.height=e)}),this.plus({name:"color",typeParam:"DColor",param:"color",title:"color",valueStart:t.LIGHT_COLOR},function(e){var i=e;if("string"==typeof i&&-1!=i.indexOf("x")){var A=i.split("x");i="#"+A[1]}t.sunLight.color=new THREE.Color(i)}),this.plus({name:"slider",typeParam:"DSliderBig",param:"bias",title:"bias",min:-.05,max:.05,value:0,okrug:1e4,valueStart:t.LIGHT_BIAS},t.sunLight.shadow),this.plus({name:"slider1",typeParam:"DSliderBig",param:"intensity",title:"intensity",min:0,max:5,value:1,okrug:100,valueStart:t.SHADOW_INTENSITY},t.sunLight),this.plus({name:"slider2",typeParam:"DSliderBig",param:"radius",title:"radius",min:0,max:50,value:1,valueStart:t.SHADOW_RADIUS},t.sunLight.shadow),this.plus({name:"check2",typeParam:"DCheckBox",param:"bAlphaForCoating",title:"SAMPLE_ALPHA..",value:!0,valueStart:!1},function(e){var i=t.renderer.getContext();e?i.enable(i.SAMPLE_ALPHA_TO_COVERAGE):i.disable(i.SAMPLE_ALPHA_TO_COVERAGE)}),this.plus({name:"check3",typeParam:"DCheckBox",param:"fixation",title:"fixation",value:!1,valueStart:t.utility.FIXATION},t.utility),this.plus({name:"slider4",typeParam:"DSliderBig",param:"rotationX",title:"rotationX",min:-Math.PI,max:Math.PI,okrug:100,value:0,valueStart:t.utility.ROTATION_X},t.utility),this.plus({name:"slider5",typeParam:"DSliderBig",param:"rotationZ",title:"rotationZ",min:-Math.PI,max:Math.PI,okrug:100,value:0,valueStart:t.utility.ROTATION_Z},t.utility),this.plus({name:"slider6",typeParam:"DSliderBig",param:"distance",title:"distance",min:0,max:1e4,value:0,valueStart:t.utility.DISTANCE},t.utility),this.plus({name:"slider7",typeParam:"DSliderBig",param:"cubWidth",title:"cubWidth",min:10,max:1e4,value:0,valueStart:t.utility.CUB_WIDTH},t.utility),this.plus({name:"slider8",typeParam:"DSliderBig",param:"cubHeight",title:"cubHeight",min:10,max:1e4,value:0,valueStart:t.utility.CUB_HEIGHT},t.utility),this.plus({name:"slider9",typeParam:"DSliderBig",param:"distanceUpdateShadow",title:"distUpdateShadow ",min:-1,max:500,value:0,valueStart:t.utility.distanceUpdateShadow},t.utility)}function I(e,t){x.call(this,e,t);var i=this;this.type="SceneBox2",this.plus({name:"check",typeParam:"DCheckBox",param:"active",title:"active",valueStart:!0},function(e){t.utility.ambientActiv(e)}),this.plus({name:"color",typeParam:"DColor",param:"color",title:"color",tipParam:2,valueStart:t.AMBIEN_COLOR},function(e){var A=e;if("string"==typeof A&&-1!=A.indexOf("x")){var a=A.split("x");A="#"+a[1]}i.setValue(this.object.param,A),t.ambientLight.color=new THREE.Color(A)}),this.plus({name:"slider",typeParam:"DSliderBig",param:"intensity",title:"intensity",min:0,max:5,okrug:100,valueStart:t.AMBIEN_INTENSITY},t.ambientLight)}function C(e,t){x.call(this,e,t),this.type="SceneBox3";this.plus({name:"check",typeParam:"DCheckBox",param:"active",title:"active",valueStart:!1},function(e){t.utility.sky.active=e}),this.plus({name:"color",typeParam:"DColor",param:"color",title:"color",valueStart:t.utility.sky.COLOR},t.utility.sky),this.plus({name:"contLoader",typeParam:"DVisualLoader",param:"link",title:"LoadPic",valueStart:t.utility.sky.LINK},t.utility.sky),this.plus({name:"slider",typeParam:"DSliderBig",param:"radius",title:"radius",min:10,max:15e3,okrug:1,valueStart:t.utility.sky.RADIUS},t.utility.sky)}function y(e,t){x.call(this,e,t),this.type="SceneBox5";this.plus({name:"text1",typeParam:"DLabel",param:"xz",title:"Load",valueStart:"reflect"}),this.plus({name:"contLoader",typeParam:"DVisualLoader",param:"link",title:"Load",valueStart:"null"},function(e){t.cubeMap.link=e}),this.plus({name:"sliderExp",typeParam:"DSliderBig",param:"exposure",title:"exposure",min:-10,max:10,okrug:100,valueStart:-1},function(e){t.cubeMap.exposure=e}),this.plus({name:"slider1",typeParam:"DSliderBig",param:"gamma",title:"gamma//в хдр",min:-10,max:10,okrug:100,valueStart:-1},function(e){t.cubeMap.gamma=e}),this.plus({name:"text1",typeParam:"DLabel",param:"xz",title:"Load",valueStart:"refract"}),this.plus({name:"contLoader1",typeParam:"DVisualLoader",param:"link1",title:"Load",valueStart:"null"},function(e){t.cubeMap1.link=e}),this.plus({name:"sliderExp1",typeParam:"DSliderBig",param:"exposure1",title:"exposure",min:-10,max:10,okrug:100,valueStart:-1},function(e){t.cubeMap1.exposure=e}),this.plus({name:"slider2",typeParam:"DSliderBig",param:"gamma1",title:"gamma//в хдр",min:-10,max:10,okrug:100,valueStart:-1},function(e){t.cubeMap1.gamma=e})}function b(e,t){x.call(this,e,t),this.type="SceneBox6";var i=this;this.plus({name:"check0",typeParam:"DCheckBox",param:"alwaysRender",title:"autoRender",valueStart:!1},function(e){t.alwaysRender!==e&&(t.alwaysRender=e)}),this.plus({name:"slider",typeParam:"DSliderBig",param:"fov",title:"fov",min:0,max:90,okrug:1,valueStart:t.FOV}),this.plus({name:"slider1",typeParam:"DSliderBig",param:"far",title:"far",min:100,max:5e4,okrug:1,valueStart:t.FAR},function(e){t.camera.far!=e&&(t.camera.far=e,t.camera.updateProjectionMatrix())}),this.plus({name:"slider2",typeParam:"DSliderBig",param:"minZum",title:"minZum",min:0,max:2e4,okrug:1,valueStart:0},function(e){t.minZum=e,t.minZum>t.maxZum&&(t.maxZum=t.minZum,i.setValue("maxZum",e))}),this.plus({name:"slider3",typeParam:"DSliderBig",param:"maxZum",title:"maxZum",min:0,max:2e4,okrug:1,valueStart:2e4},function(e){t.maxZum=e,t.maxZum<t.minZum&&(t.minZum=t.maxZum,i.setValue("minZum",e))}),this.plus({name:"slider4",typeParam:"DSliderBig",param:"zume",title:"powerZum",min:1,max:2e4,okrug:1,valueStart:250}),this.plus({name:"slider11",typeParam:"DSliderBig",param:"powerZum",title:"zoom",min:1,max:100,okrug:1,valueStart:50},function(e){t.position3d.powerZum!==e&&(t.position3d.powerZum=e)}),this.plus({name:"slider5",typeParam:"DSliderBig",param:"minRotationX",title:"minAngel",min:0,max:3,okrug:100,valueStart:2.5},function(e){t.minRotationX!==e&&(t.minRotationX=e)}),this.plus({name:"slider6",typeParam:"DSliderBig",param:"maxRotationX",title:"maxAngel",min:0,max:3,okrug:100,valueStart:0},function(e){t.maxRotationX!==e&&(t.maxRotationX=e)}),this.plus({name:"check1",typeParam:"DCheckBox",param:"debug",title:"debug",valueStart:!0},function(e){t.utility.debug!==e&&(t.utility.debug=e)}),this.plus({name:"check2",typeParam:"DCheckBox",param:"isDragPan",title:"isDragPan",valueStart:!0},function(e){t.position3d.isDragPan!==e&&(t.position3d.isDragPan=e)}),this.plus({name:"check3",typeParam:"DCheckBox",param:"alphaAd",title:"alpha Админ для фотки",valueStart:!1}),this.plus({name:"slider7",typeParam:"DSliderBig",param:"zume",title:"zoom",min:5,max:2e3,okrug:1,valueStart:250},function(e){t.zume=e}),this.plus({name:"slider8",typeParam:"DSliderBig",param:"rotationX",title:"rotationX",min:-Math.PI,max:Math.PI,okrug:100,valueStart:0},function(e){t.rotationX=e}),this.plus({name:"slider9",typeParam:"DSliderBig",param:"rotationZ",title:"rotationZ",min:-Math.PI,max:Math.PI,okrug:100,valueStart:0},function(e){t.rotationZ=e}),this.plus({name:"slider10",typeParam:"DSliderBig",param:"globZ",title:"globZ",min:-1e3,max:1e3,okrug:1,valueStart:0},function(e){t.yVerh=e})}function T(e,t){x.call(this,e,t),this.type="SceneBox7";this.plus({name:"check",typeParam:"DCheckBox",param:"active",title:"active",valueStart:!1},t.efect),this.plus({name:"slider",typeParam:"DSliderBig",param:"edgeStrength",title:"edgeStrength",min:0,max:10,okrug:100,valueStart:t.efect.edgeStrength},t.efect),this.plus({name:"slider1",typeParam:"DSliderBig",param:"edgeGlow",title:"edgeGlow",min:0,max:1,okrug:100,valueStart:t.efect.edgeGlow},t.efect),this.plus({name:"slider2",typeParam:"DSliderBig",param:"edgeThickness",title:"edgeThickness",min:0,max:5,okrug:100,valueStart:t.efect.edgeThickness},t.efect),this.plus({name:"slider3",typeParam:"DSliderBig",param:"pulsePeriod",title:"pulsePeriod",min:0,max:5,okrug:100,valueStart:t.efect.pulsePeriod},t.efect),this.plus({name:"contLoader",typeParam:"DVisualLoader",param:"linkTextur",title:"linkTextur",valueStart:t.efect.linkTextur},t.efect),this.plus({name:"color",typeParam:"DColor",param:"visibleEdgeColor",title:"vEdgeColor",valueStart:t.efect.visibleEdgeColor},t.efect),this.plus({name:"color1",typeParam:"DColor",param:"hiddenEdgeColor",title:"hEdgeColor",valueStart:t.efect.hiddenEdgeColor},t.efect)}function _(e,t){x.call(this,e,t),this.type="SceneBox9";t.sbfog=new w(t),this.plus({name:"check",typeParam:"DCheckBox",param:"active",title:"active",valueStart:!1},function(e){t.sbfog.active=e}),this.plus({name:"color1",typeParam:"DColor",param:"color",title:"outlineColor1",valueStart:t.sbfog._color},function(e){var i=e;t.sbfog.color=i}),this.plus({name:"slider1",typeParam:"DSliderBig",param:"near",title:"near",min:0,max:1e4,okrug:1,valueStart:50},t.sbfog),this.plus({name:"slider2",typeParam:"DSliderBig",param:"far",title:"far",min:0,max:2e4,okrug:1,valueStart:100},t.sbfog)}function w(e){this._active=!1,this._color="#ffffff",this._near=50,this._far=1e3,this.visi=e,this.fog=new THREE.Fog(this._color,this._near,this._far)}function F(e){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function S(e,t){return!t||"object"!==F(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function M(e,t){return(M=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}w.prototype={set active(e){this._active!=e&&(this._active=e,1==this._active?this.visi.scene.fog=this.fog:this.visi.scene.fog=null)},get active(){return this._active},set color(e){this._color!=e&&(this._color=e,this.fog.color=new THREE.Color(e))},get color(){return this._color},set near(e){this._near!=e&&(this._near=e,this.fog.near=e)},get near(){return this._near},set far(e){this._far!=e&&(this._far=e,this.fog.far=e)},get far(){return this._far}};var B=function(e){function t(e,i,A,a){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=S(this,P(t).call(this))).type="Grid";var r=new THREE.TextureLoader;n.texture=r.load(A),n.texture.wrapS=THREE.RepeatWrapping,n.texture.wrapT=THREE.RepeatWrapping,n.texture.repeat.set(i,i);var s=new THREE.MeshPhongMaterial({color:16777215,map:n.texture});s.side=THREE.DoubleSide;var o=new THREE.Mesh(new THREE.PlaneBufferGeometry(e,e,1,1),s);return n.add(o),o.castShadow=!0,o.receiveShadow=!0,null!=a&&(s.transparent=!0,s.opacity=a),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&M(e,t)}(t,THREE.Object3D),t}(),R=i(9);function D(e){THREE.Group.call(this),this.type="MeshCombined",this._meshes=e,this._ready=!1,this.init()}D.prototype=Object.create(THREE.Group.prototype),D.constructor=D,Object.defineProperties(D.prototype,{}),D.prototype.canAnalyze=function(){return this._meshes.reduce(function(e,t){return e&&t.geometry},!0)},D.prototype._getMaterialKey=function(e){return e.material.uuid},D.prototype.init=function(){var e=this;if(this._ready||!this.canAnalyze)return!1;var t=[],i={};return this._meshes.forEach(function(e){var t=e.geometry.uuid;i[t]||(i[t]=[]),i[t].push(e)}),Object.keys(i).forEach(function(A){var a=i[A],n=a[0].geometry;if(1!==a.length){var r={};a.forEach(function(t){var i=e._getMaterialKey(t);r[i]||(r[i]=[]),r[i].push(t)}),Object.keys(r).forEach(function(e){var i=r[e],A=i[0].material,a=i.length,s=new THREE.InstancedMesh(n,A.clone(),a);t.push(s),i.forEach(function(e,t){s.setQuaternionAt(t,e.quaternion),s.setPositionAt(t,e.position),s.setScaleAt(t,e.scale)}),s.needsUpdate()})}else t.push(a[0])}),t.forEach(function(t){return e.add(t)}),!0};var N=new THREE.MeshDepthMaterial;N.depthPacking=THREE.RGBADepthPacking,N.clipping=!0,N.defines={INSTANCE_TRANSFORM:""};var Q=THREE.ShaderLib.distanceRGBA,L=THREE.UniformsUtils.clone(Q.uniforms),H=new THREE.ShaderMaterial({defines:{USE_SHADOWMAP:"",INSTANCE_TRANSFORM:""},uniforms:L,vertexShader:Q.vertexShader,fragmentShader:Q.fragmentShader,clipping:!0});THREE.InstancedMesh=function(e,t,i){THREE.Mesh.call(this,(new U).setGeometry(e),t);var A=this;this.type="InstancedMesh",this.numInstances=i||1,this.customDepthMaterial=N,this.customDistanceMaterial=H,this.onAfterRender=function(e,t,i,a,n,r){A.geometry.update(i)}},THREE.InstancedMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.InstancedMesh.constructor=THREE.InstancedMesh,Object.defineProperties(THREE.InstancedMesh.prototype,{material:{set:function(e){this._material=e,this._material.defines=this._material.defines||{},this._material.defines.INSTANCE_TRANSFORM="",this._material.needsUpdate=!0},get:function(){return this._material}},geometry:{set:function(e){e instanceof U?this._geometry=e:this._geometry.setGeometry(e)},get:function(){return this._geometry}},numInstances:{set:function(e){this._numInstances=e,this.geometry.setCount(this.numInstances)},get:function(){return this._numInstances}}}),THREE.InstancedMesh.prototype.setPositionAt=function(e,t){this.geometry.setPositionAt(e,t)},THREE.InstancedMesh.prototype.setQuaternionAt=function(e,t){this.geometry.setQuaternionAt(e,t)},THREE.InstancedMesh.prototype.setScaleAt=function(e,t){this.geometry.setScaleAt(e,t)},THREE.InstancedMesh.prototype.getPositionAt=function(e,t){return this.geometry.getPositionAt(e,t)},THREE.InstancedMesh.prototype.getQuaternionAt=function(e,t){return this.geometry.getQuaternionAt(e,t)},THREE.InstancedMesh.prototype.getScaleAt=function(e,t){return this.geometry.getScaleAt(e,t)},THREE.InstancedMesh.prototype.needsUpdate=function(){this.geometry.needsUpdate=!0,this.geometry.computeBoundingSphere()};var O;new THREE.BoxBufferGeometry(1,1,1),new THREE.MeshNormalMaterial({wireframe:!0});function U(){THREE.InstancedBufferGeometry.call(this),this.count=0;var e=this;this.boundOrigin=new THREE.Box3,this.arrTransform=[],this.gridTransform=new j(this.arrTransform),this.setCount=function(e){if(this.count=e,(this.maxInstancedCount||0)<e&&(!this.attributes.instanceQuaternion||this.attributes.instanceQuaternion.count<e)){var t={instanceQuaternion:new Float32Array(4*e),instancePosition:new Float32Array(3*e),instanceScale:new Float32Array(3*e)};this.setAttribute("instanceQuaternion",new THREE.InstancedBufferAttribute(t.instanceQuaternion,4)),this.setAttribute("instancePosition",new THREE.InstancedBufferAttribute(t.instancePosition,3)),this.setAttribute("instanceScale",new THREE.InstancedBufferAttribute(t.instanceScale,3)),this.needsUpdate=!0}for(var i=0;i<e;i++)this.arrTransform[i]=new X(this.boundOrigin);this.maxInstancedCount=e},this.setGeometry=function(e){return this.copy(e),this.boundOrigin.setFromBufferAttribute(this.attributes.position),this};var t=new THREE.Frustum,i=new THREE.Matrix4;this.arrTransformVisible=[],this.update=function(A){i.multiplyMatrices(A.projectionMatrix,A.matrixWorldInverse),t.setFromMatrix(i);var a=0;this.arrTransformVisible=[];for(var n=0;n<this.gridTransform.arrGridIndex.length;n++){var r=this.gridTransform.arrGridIndex[n];if(t.intersectsBox(r.boundingBox))for(var s=0;s<r.arrTransform.length;s++){var o=r.arrTransform[s];this.arrTransformVisible.push(o),this.setTransformAt(a++,o)}}e.maxInstancedCount=a,e.needsUpdate=!0},this.updateGrid=function(){this.gridTransform.updateGrid()}}function X(e){this.boundOrigin=e,this._boundingBox=null,this.p=new THREE.Vector3,this.s=new THREE.Vector3(1,1,1),this.q=new THREE.Quaternion,this.setP=function(e){this.p.copy(e)},this.setS=function(e){this.s.copy(e)},this.setQ=function(e){this.q.copy(e)}}function j(e){var t=this;this.arrTransform=e;var i=100;function A(e){var A="x"+Math.floor(e.x/i)+"y"+Math.floor(e.y/i)+"z"+Math.floor(e.z/i);return t.cache[A]||(t.cache[A]=new G),t.cache[A]}this.arrGridIndex=[],this.cache={},this.updateGrid=function(){this.arrGridIndex.length=0,this.cache={};for(var e=0;e<this.arrTransform.length;e++){var t=this.arrTransform[e];A(t.p).arrTransform.push(t)}for(var i in this.cache)this.cache[i].computeBoundingBox(),this.arrGridIndex.push(this.cache[i])}}function G(){this.arrTransform=[],this._boundingBox=null}U.prototype=Object.create(THREE.InstancedBufferGeometry.prototype),U.constructor=U,U.prototype.setTransformAt=function(e,t){this.attributes.instanceScale.setXYZ(e,t.s.x,t.s.y,t.s.z),this.attributes.instancePosition.setXYZ(e,t.p.x,t.p.y,t.p.z),this.attributes.instanceQuaternion.setXYZW(e,t.q.x,t.q.y,t.q.z,t.q.w)},U.prototype.setPositionAt=function(e,t){this.arrTransform[e].setP(t),this.setTransformAt(e,this.arrTransform[e])},U.prototype.setQuaternionAt=function(e,t){this.arrTransform[e].setQ(t),this.setTransformAt(e,this.arrTransform[e])},U.prototype.setScaleAt=function(e,t){this.arrTransform[e].setS(t),this.setTransformAt(e,this.arrTransform[e])},U.prototype.getPositionAt=function(e,t){return t?t.copy(this.arrTransform[e].p):this.arrTransform[e].p},U.prototype.getQuaternionAt=function(e,t){return t?t.copy(this.arrTransform[e].q):this.arrTransform[e].q},U.prototype.getScaleAt=function(e,t){return t?t.copy(this.arrTransform[e].s):this.arrTransform[e].s},U.prototype.computeBoundingSphere=function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere),this.computeBoundingBox(),this.boundingBox.getBoundingSphere(this.boundingSphere),this.updateGrid()},U.prototype.computeBoundingBox=function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3),this.boundingBox.makeEmpty();for(var e=0,t=this.count;e<t;e++)this.boundingBox.union(this.getBoundingBoxAt(e))},U.prototype.getBoundingBoxAt=function(e){return this.arrTransform[e].boundingBox},Object.defineProperties(U.prototype,{needsUpdate:{set:function(e){this.attributes.instancePosition.needsUpdate=e,this.attributes.instanceQuaternion.needsUpdate=e,this.attributes.instanceScale.needsUpdate=e},get:function(){return!1}}}),X.prototype.computeBoundingBox=(O=new THREE.Matrix4,function(){return this._boundingBox||(this._boundingBox=new THREE.Box3),O.compose(this.p,this.q,this.s),this.boundingBox.copy(this.boundOrigin),this.boundingBox.applyMatrix4(O),this.boundingBox}),Object.defineProperties(X.prototype,{boundingBox:{set:function(e){this._boundingBox=e},get:function(){return this._boundingBox||this.computeBoundingBox()}}}),G.prototype.computeBoundingBox=function(){this._boundingBox||(this._boundingBox=new THREE.Box3),this.boundingBox.makeEmpty();for(var e=0,t=this.arrTransform.length;e<t;e++)this.boundingBox.union(this.arrTransform[e].boundingBox);return this.boundingBox},Object.defineProperties(G.prototype,{boundingBox:{set:function(e){this._boundingBox=e},get:function(){return this._boundingBox||this.computeBoundingBox()}}});var k=["#ifndef INSTANCE_TRANSFORM","vec3 transformed = vec3( position );","#else","#ifndef INSTANCE_MATRIX","mat4 _instanceMatrix = getInstanceMatrix();","#define INSTANCE_MATRIX","#endif","vec3 transformed = ( _instanceMatrix * vec4( position , 1. )).xyz;","#endif"].join("\n"),Y=["#ifdef USE_COLOR","diffuseColor.rgb *= vColor;","#endif","#if defined(INSTANCE_COLOR)","diffuseColor.rgb *= vInstanceColor;","#endif"].join("\n"),z=["#ifdef USE_COLOR","varying vec3 vColor;","#endif","#if defined( INSTANCE_COLOR )","varying vec3 vInstanceColor;","#endif"].join("\n"),V=["#ifdef USE_COLOR","vColor.xyz = color.xyz;","#endif","#if defined( INSTANCE_COLOR ) && defined( INSTANCE_TRANSFORM )","vInstanceColor = instanceColor;","#endif"].join("\n"),W=["#ifdef FLIP_SIDED","objectNormal = -objectNormal;","#endif","#ifndef INSTANCE_TRANSFORM","vec3 transformedNormal = normalMatrix * objectNormal;","#else","#ifndef INSTANCE_MATRIX ","mat4 _instanceMatrix = getInstanceMatrix();","#define INSTANCE_MATRIX","#endif","#ifndef INSTANCE_UNIFORM","vec3 transformedNormal =  transposeMat3( inverse( mat3( modelViewMatrix * _instanceMatrix ) ) ) * objectNormal ;","#else","vec3 transformedNormal = ( modelViewMatrix * _instanceMatrix * vec4( objectNormal , 0.0 ) ).xyz;","#endif","#endif"].join("\n"),Z=["#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )","varying vec2 vUv;","uniform mat3 uvTransform;","#endif","#ifdef INSTANCE_TRANSFORM","mat3 inverse(mat3 m) {","float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];","float a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];","float a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];","float b01 = a22 * a11 - a12 * a21;","float b11 = -a22 * a10 + a12 * a20;","float b21 = a21 * a10 - a11 * a20;","float det = a00 * b01 + a01 * b11 + a02 * b21;","return mat3(b01, (-a22 * a01 + a02 * a21), ( a12 * a01 - a02 * a11),","b11, ( a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10),","b21, (-a21 * a00 + a01 * a20), ( a11 * a00 - a01 * a10)) / det;","}","attribute vec3 instancePosition;","attribute vec4 instanceQuaternion;","attribute vec3 instanceScale;","#if defined( INSTANCE_COLOR )","attribute vec3 instanceColor;","varying vec3 vInstanceColor;","#endif","mat4 getInstanceMatrix(){","vec4 q = instanceQuaternion;","vec3 s = instanceScale;","vec3 v = instancePosition;","vec3 q2 = q.xyz + q.xyz;","vec3 a = q.xxx * q2.xyz;","vec3 b = q.yyz * q2.yzz;","vec3 c = q.www * q2.xyz;","vec3 r0 = vec3( 1.0 - (b.x + b.z) , a.y + c.z , a.z - c.y ) * s.xxx;","vec3 r1 = vec3( a.y - c.z , 1.0 - (a.x + b.z) , b.y + c.x ) * s.yyy;","vec3 r2 = vec3( a.z + c.y , b.y - c.x , 1.0 - (a.x + b.x) ) * s.zzz;","return mat4(","r0 , 0.0,","r1 , 0.0,","r2 , 0.0,","v  , 1.0",");","}","#endif"].join("\n");function J(e,t,i){this.type="PMFilt";var A=this;this.par=e,this.visi3D=t,this.objbase=i,this.ceshGeom=new te(this),this.setObjS=function(e,t){!0,e.object.filt&&0!=e.object.filt.length?new q(this,e,t):this.finalObjS(e,t)},this.finalObjS=function(e,t){e.object.param&&(1==e.object.param.kesh&&A.ceshGeom.set(e.content3d),null!=e.object.param.sG&&1==e.object.param.sG&&A.ceshGeom.groupGeometri(e.content3d)),t()},this.dragParam=function(e,t){if(e.children)for(var i=e.children.length-1;i>=0;i--)this.dragParam(e.children[i],t);null==e.bs&&(e.castShadow=t.tOt,e.receiveShadow=t.tNa);var A=t.rO;e.iz&&e.iz.renderOrder&&(A=e.iz.renderOrder),e.renderOrder=A},this.dragPozition=function(e){var t=!1;e.object&&e.object.psm&&(t=!0,null!=e.object.psm.active&&0==e.object.psm.active&&(t=!1)),1==t?(e.content3d.position.set(e.object.psm.p[0],e.object.psm.p[1],e.object.psm.p[2]),e.content3d.rotation.set(e.object.psm.r[0],e.object.psm.r[1],e.object.psm.r[2]),e.content3d.scale.set(e.object.psm.s[0],e.object.psm.s[1],e.object.psm.s[2])):(e.content3d.position.set(0,0,0),e.content3d.rotation.set(0,0,0),e.content3d.scale.set(1,1,1))}}function q(e,t,i){this.type="StartFilt";this.par=e,this.hron=t,this.fun=i,this.hron.filt=this,this.array=[];var A,a=0;this.dragFilt=function(){a!=this.hron.object.filt.length?(A=this.hron.object.filt[a].type,a++,"mark"==A&&this.array.push(new ee(this,this.hron.object.filt[a-1],this.array.length)),"material"==A&&this.array.push(new K(this,this.hron.object.filt[a-1],this.array.length))):this.par.finalObjS(this.hron,this.fun)},this.dragFilt()}function K(e,t,i){this.type="PMMaterial";this.par=e,this.obj=t,this.idArr=i,this.mat=this.par.par.par.mat.getTestTitle(t.id),null!=this.mat?(this.parsing=function(e){if(e.children)for(var t=e.children.length-1;t>=0;t--)this.parsing(e.children[t]);null!=e.material&&(e.material=this.mat)},this.parsing(e.hron.content3d),this.par.dragFilt()):this.par.dragFilt()}function ee(e,t,i){this.type="PMMark";var A=this;if(this.par=e,this.obj=t,this.idArr=i,this.idKey=t.id,this.c3d=e.hron.content3d,this.arrName=[],this.arrayObj=[],"null"!=this.idKey){var a,n=!0;if(-1!=t.id.indexOf("|")){for(var r=t.id.split("|"),s=r[0].split(","),o=r[1].split(","),h=0;h<s.length;h++)this.arrName[h]={name:s[h],id:1*o[h],obCont:null};n=!1}else n=!0,this.arrName[0]={name:"null",id:t.id,obCont:null};this.parsing=function(e){if(e.children)for(var t=e.children.length-1;t>=0;t--)this.parsing(e.children[t]);if("Mesh"==e.type)if(n)a=this.arrName[0].obCont.clone(),e.parent.add(a),a.position.set(e.position.x,e.position.y,e.position.z),a.rotation.set(e.rotation.x,e.rotation.y,e.rotation.z),a.scale.set(e.scale.x,e.scale.y,e.scale.z),e.parent.remove(e);else if(e.name)for(t=this.arrName.length-1;t>=0;t--)if(-1!=e.name.indexOf(this.arrName[t].name))return a=this.arrName[t].obCont.clone(),e.parent.add(a),a.position.set(e.position.x,e.position.y,e.position.z),a.rotation.set(e.rotation.x,e.rotation.y,e.rotation.z),a.scale.set(e.scale.x,e.scale.y,e.scale.z),void e.parent.remove(e)},this.loadMMM=function(e){this.par.par.par.getId(1*e.id,function(t){e.obCont=t,A.loadMod()})},this.loadMod=function(){for(var e=0;e<this.arrName.length;e++)if(null==this.arrName[e].obCont)return void this.loadMMM(this.arrName[e]);this.parsing(this.c3d),this.par.dragFilt()},this.loadMod()}else this.par.dragFilt()}function te(e){this.type="CeshGeom";var t=this;t.kolCount=9999,this.par=e;var i,A,a={};function n(e,t,i,A){i&&t.updateMatrixWorld(),A&&e.updateMatrixWorld();var a=(new THREE.Matrix4).getInverse(t.matrixWorld);e.parent&&a.multiply(e.parent.matrixWorld),e.applyMatrix(a),t.add(e)}this.set=function(e){for(var i in a={},t.fillObjMesh(e),a)a[i].length>=2&&new ie(this,e,a[i])},this.sliteGeom=new Ae,this.groupGeometri=function(e){a={},t.fillObjMesh(e);var r=!1;for(var s in a)if(a[s].length>=2){r=!0,this.sliteGeom.start(a[s][0].geometry.clone());for(var o=a[s].length-1;o>=0;o--)n(i=a[s][o],e),this.sliteGeom.setMesh(i),i.parent.remove(i);this.sliteGeom.final(),A=new THREE.Mesh(this.sliteGeom.creatGeom,i.material),e.add(A)}r&&t.killNull(e)},t.killNull=function(e){if(e.children)for(var i=e.children.length-1;i>=0;i--)t.killNull(e.children[i]);null!=e.geometry||null==e.children||0!=e.children.length||null==e.parent||e.parent.remove(e)},t.fillObjMesh=function(e){for(var i=function e(t){var i=[];t.updateMatrixWorld();t instanceof THREE.Mesh&&i.push(t);for(var A=0;A<t.children.length;A++)for(var a=e(t.children[A]),n=0;n<a.length;n++)i.push(a[n]);return i}(e),A=0;A<i.length;A++)i[A].geometry&&i[A].geometry.index&&i[A].geometry.index.count<t.kolCount&&(a[i[A].geometry.uuid]=a[i[A].geometry.uuid]||[],a[i[A].geometry.uuid].push(i[A]))},this.moveObject=function(e,t,i,A){n(e,t,i,A)}}function ie(e,t,i){this.type="LoadTime";var A,a=this;this.par=e,this.c3d=t,this.arr=i,this.mesh=i[0],this.geom=i[0].geometry,this.mate=i[0].material;var n=!0;this.initLoad=function(){n=!1,a.mate&&null!=a.mate.idObj&&0==a.mate.loadTexure&&(n=!0),0==n?setTimeout(function(){a.initLoad()},50):a.creat()},this.creat=function(){for(var e=i.length-1;e>=0;e--)A=i[e],this.par.moveObject(A,t),A.parent.remove(A);this.meshCombined=new D(i),t.add(this.meshCombined);for(this.meshCombined._meshes,e=0;e<this.meshCombined.children.length;e++)this.meshCombined.children[e].castShadow=A.castShadow,this.meshCombined.children[e].receiveShadow=A.receiveShadow,this.meshCombined.children[e].renderOrder=A.renderOrder;this.par.killNull(t)},this.initLoad()}function Ae(){this.type="SliteGeom";var e;this.geometry,this.kol,this.ah=[],this.sah=0,this.sahMesh=0,this.creatGeom,this.ap=[],this.ai=[],this.auv=[],this.start=function(e){this.geometry=e,this.creatGeom=new THREE.BufferGeometry,this.sah=0,this.sahMesh=0,this.ap=[],this.ai=[],this.auv=[],this.sPosit()},this.sPosit=function(){for(var e=0;e<this.geometry.index.count;e++)null==this.ah[this.sah]&&(this.ah[this.sah]=new ae),this.ah[this.sah].posOld.set(this.geometry.attributes.position.array[3*this.geometry.index.array[e]],this.geometry.attributes.position.array[3*this.geometry.index.array[e]+1],this.geometry.attributes.position.array[3*this.geometry.index.array[e]+2]),this.ah[this.sah].uv.set(this.geometry.attributes.uv.array[2*this.geometry.index.array[e]],this.geometry.attributes.uv.array[2*this.geometry.index.array[e]+1]),this.ah[this.sah].index=this.geometry.index.array[e],this.sah++},this.setMesh=function(t){e=this.sahMesh*this.sah;for(var i=0;i<this.sah;i++)this.ah[i].setMesh(t),this.ap.push(this.ah[i].pos.x,this.ah[i].pos.y,this.ah[i].pos.z),this.auv.push(this.ah[i].uv.x,this.ah[i].uv.y),this.ai.push(this.ah[i].index+e);this.sahMesh++},this.final=function(){this.creatGeom.setIndex(this.ai),this.creatGeom.addAttribute("position",new THREE.BufferAttribute(new Float32Array(this.ap),3)),this.creatGeom.addAttribute("uv",new THREE.BufferAttribute(new Float32Array(this.auv),2)),this.creatGeom.attributes.position.needsUpdate=!0,this.creatGeom.attributes.uv.needsUpdate=!0,this.creatGeom.computeVertexNormals(),this.creatGeom.attributes.normal.needsUpdate=!0,this.creatGeom.computeBoundingBox(),this.creatGeom.computeBoundingSphere()}}function ae(){this.type="SliteGeom",this.pos=new THREE.Vector3,this.posOld=new THREE.Vector3,this.uv=new THREE.Vector2,this.index=0,this.setMesh=function(e){this.pos.set(this.posOld.x,this.posOld.y,this.posOld.z),this.pos.applyMatrix4(e.matrix)}}function ne(e){return(ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function re(e,t,i){this.type="PMFilt";var A,a,n,r=this;this.par=e,this.visi3D=t,this.objbase=i,this.setHron=function(e,t){var i,A;i=e.object.iz,A=e.content3d,t&&(A=t),null!=A&&null!=i&&1==i.a&&this.setMod(A,this.strToObj(i.str),i.st)},this.strToObj=function(e){for(var t="",i=0;i<e.length;i++)"|"==e[i]?t+='"':t+=e[i];return JSON.parse(t)},this.getIz=function(e){if(A++,null!=e.iz){var t=0;null!=e.iz.renderOrder&&(0==t&&(t={}),t.renderOrder=e.iz.renderOrder),null!=e.iz.bs&&(0==t&&(t={}),t.bs=e.iz.bs),null!=e.iz.mod&&(0==t&&(t={}),t.mod=e.iz.mod),null!=e.iz.position&&(0==t&&(t={}),t.position=e.iz.position),null!=e.iz.scale&&(0==t&&(t={}),t.scale=e.iz.scale),null!=e.iz.rotation&&(0==t&&(t={}),t.rotation=e.iz.rotation),null!=e.iz.visible&&(0==t&&(t={}),t.visible=e.iz.visible),null!=e.iz.material&&(0==t&&(t={}),t.material=e.iz.material),0!=t&&(t.sah=A),a.push(t)}else a.push(0);if(e.children&&null==e.notPar)for(var i=0;i<e.children.length;i++)this.getIz(e.children[i])},this.getMod=function(e){return A=-1,a=[],this.getIz(e),a},this.setIz=function(e,t){if(n[++A]&&0!=n[A]){if(e.iz={},null!=n[A].mod){t&&(e.iz.mod=n[A].mod);for(var i=new THREE.Object3D,a=0,s=0;s<e.parent.children.length;s++)e.parent.children[s].uuid==e.uuid&&(a=s);i.notPar=!0,e.parent.add(i),e.parent.remove(e),i.parent.children.splice(i.parent.children.length-1,1),i.parent.children.splice(a,0,i),r.par.getId(n[A].mod,function(e){i.add(e)})}null!=n[A].renderOrder&&(t&&(e.iz.renderOrder=n[A].renderOrder),e.renderOrder=n[A].renderOrder),null!=n[A].bs&&(t&&(e.iz.bs=n[A].bs),e.bs=n[A].bs),null!=n[A].position&&(t&&(e.iz.position=n[A].position),e.position.set(n[A].position.x,n[A].position.y,n[A].position.z)),null!=n[A].scale&&(t&&(e.iz.scale=n[A].scale),e.scale.set(n[A].scale.x,n[A].scale.y,n[A].scale.z)),null!=n[A].rotation&&(t&&(e.iz.rotation=n[A].rotation),e.rotation.set(n[A].rotation.x,n[A].rotation.y,n[A].rotation.z)),null!=n[A].visible&&(t&&(e.iz.visible=n[A].visible),e.visible=n[A].visible),null!=n[A].material&&e.material&&(null==e.oldName&&(e.oldName=e.material.name),t&&(e.iz.material=n[A].material),e.material=r.par.mat.getIDReturn(n[A].material))}if(e.children&&null==e.notPar)for(s=0;s<e.children.length;s++)this.setIz(e.children[s])},this.setMod=function(e,t,i){"object"==ne(t)&&null!=t[0]&&(n=t,A=-1,this.setIz(e,i))},this.setMat=function(e,t,i,A){if(null!=A&&(A=!0),null!=e.material&&(null==e.oldName&&(e.oldName=e.material.name),"string"==typeof t&&(t=this.par.mat.getIDReturn(t,A)),null==i?(e.material=t,null==e.iz&&(e.iz={}),e.iz.material=t.idUz):e.oldName&&-1!=e.oldName.indexOf(i)&&(e.material=t,null==e.iz&&(e.iz={}),e.iz.material=t.idUz)),e.children&&null==e.notPar)for(var a=0;a<e.children.length;a++)this.setMat(e.children[a],t,i,A)}}function se(e,t){for(var i=0;i<t.length;i++){var A=t[i];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(e,A.key,A)}}THREE.ShaderChunk.begin_vertex=k,THREE.ShaderChunk.color_fragment=Y,THREE.ShaderChunk.color_pars_fragment=z,THREE.ShaderChunk.color_vertex=V,THREE.ShaderChunk.defaultnormal_vertex=W,THREE.ShaderChunk.uv_pars_vertex=Z;var oe=function(){function e(t,i,A){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type="PMTexture",this.par=t,this.visi3D=i,this.objbase=A,this.loader=new THREE.TextureLoader,this.textureCache={},window.textureCache=this.textureCache}var t,i,A;return t=e,(i=[{key:"getById",value:function(e,t){var i=this;if(this.textureCache[e]&&this.textureCache[e].loaded)return t&&setTimeout(function(){return t(i.textureCache[e].texture)},0),this.textureCache[e].texture;var A=this.getObj(e);return this.loadTexture(A,t)}},{key:"loadTexture",value:function(e,t){var i=this;if(this.textureCache[e.id]&&this.textureCache[e.id].callbacks||(this.textureCache[e.id]={callbacks:[]}),!this.textureCache[e.id].texture){var A=window.location.href.split("/");A.pop();var a=A.join("/")+"/resources/data/"+e.id+"/pic."+e.type,n=this.loader.load(a,function(t){i.visi3D&&(i.visi3D.intRend=1),t.obj={},i.textureCache[e.id].callbacks.forEach(function(e){return e(t)}),delete i.textureCache[e.id].callbacks,i.textureCache[e.id].loaded=!0});n.arrMat=[],n.arrRun=[],n.wrapS=n.wrapT=THREE.RepeatWrapping,n.repeat.x=e.rx,n.repeat.y=e.ry,this.textureCache[e.id].texture=n}return t&&this.textureCache[e.id].callbacks.push(t),this.textureCache[e.id].texture}},{key:"updateTexture",value:function(e,t){var i=this;if(this.textureCache[e.id])if(t){var A=new Image,a=window.location.href.split("/");a.pop(),A.src=a.join("/")+"/resources/data/"+e.id+"/pic."+e.type,this.textureCache[e.id].texture.image=A,this.textureCache[e.id].loaded=!1,A.onload=function(){delete i.textureCache[e.id].callbacks,i.textureCache[e.id].loaded=!0,i.textureCache[e.id].texture.needsUpdate=!0}}else this.textureCache[e.id].texture.repeat.x=e.rx,this.textureCache[e.id].texture.repeat.y=e.ry}},{key:"getObj",value:function(e){return this.objbase.textures.find(function(t){return t.id===e})||null}}])&&se(t.prototype,i),A&&se(t,A),e}();function he(e){return(he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function le(e,t){this.type="PM";this.objbase=t,this.visi3D=e,this.plus="?1",this.loaderGLTF=new THREE.GLTFLoader,this.tex=new oe(this,e,t),this.mat=new R.a(this,e,t),this.filt=new J(this,e,t),this.iz=new re(this,e,t),this.arrayHron=[],this.getId=function(e,t,i){if(1==i)for(var A=0;A<this.arrayHron.length;A++)1==this.arrayHron[A].testId(e)&&this.arrayHron.splice(A,1);for(A=0;A<this.arrayHron.length;A++)if(1==this.arrayHron[A].testId(e))return void this.arrayHron[A].setFun(t);this.arrayHron.push(new de(this,e,t))},this.clear=function(){}}function de(e,t,i){this.type="Hron";var A,a,n=this;this.par=e,this.idObj=t,this.id=void 0,this.object=void 0,this.link=void 0,this.filt=void 0,this.content3d=void 0,this.array=[],this.array.push(i),this.boolClone=!0,this.setFun=function(e){if(null!=this.content3d)return(A=1==n.boolClone?n.content3d.clone():n.content3d).hron=this,this.par.iz.setHron(this,A),this.object.param&&this.par.filt.dragParam(A,this.object.param),void e(A);this.array.push(e)},this.finalLoad=function(e){this.getObj3D(e),this.content3d=e,e.name="hron_"+this.id,this.par.mat.setObjS(this.content3d,this.object,this.finalLoad1)},this.finalLoad1=function(){n.par.filt.setObjS(n,n.finalLoad2)},this.finalLoad2=function(){for(var e=0;e<n.array.length;e++)(A=1==n.boolClone?n.content3d.clone():n.content3d).hron=n,n.par.iz.setHron(n,A),n.object.param&&n.par.filt.dragParam(A,n.object.param),n.array[e](A)},this.start=function(e){this.object=e,null!=this.object.param.clone&&0==this.object.param.clone&&(this.boolClone=!1),this.id=e.id,this.link="resources/data/"+this.id+"/mod/"+this.object.mod.name,"n"==this.object.mod.name?this.finalLoad(new THREE.Mesh(new THREE.BoxBufferGeometry(100,100,100))):this.par.loaderGLTF.load(this.link,function(e){n.finalLoad(e.scene)})},this.testId=function(e){return a="number"==typeof e?e:e.id,(null==this.id?this.idObj.id:this.id)==a},this.getObj3D=function(t){if(null!=t.material&&null!=t.material.roughnessMap&&e.visi3D&&(t.material.envMap=e.visi3D.cubeMap.getTexture()),null!=t){if(null!=t.children)for(var i=t.children.length-1;i>=0;i--)this.getObj3D(t.children[i]);"Default_light"==t.name&&t.parent.remove(t)}},"object"!=he(t)?"number"==typeof t&&$.ajax({url:"resources/data/"+t+"/config.json"+n.par.plus,success:function(e){"string"==typeof e?n.start(JSON.parse(e)):n.start(e)},error:function(e){console.log("Что то случилось с конфигом")}}):this.start(t)}function ue(e,t){for(var i=0;i<t.length;i++){var A=t[i];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(e,A.key,A)}}i.d(t,"a",function(){return ce});var ce=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type="Glaf";var i=this;this.content3d=new THREE.Object3D,this._index=-1,this._tipVisi=-1,this._tipDrav=-1,this._id=-1,this.idBool=!1,this.idArr=[53],this.whSize=1e4,this.mobile=dcmParam.mobile,this.scale=1,this.dCont=void 0,this.main=t,this.par=t,this.otstup=5,this._free=!0,this.dCont=new DCont(document.body),this.dCV=new DCont,this.ser=window.location.href;this.ser.split("?")[0].split("index");this.resurs="resources/",this.visi3D=new g.a(t.contentHTML,null,dcmParam.mobile,!0,!1,!0,!0),this.visi3D.yes3d=!0,this.visi3D.groupObject.add(this.content3d),this.content3d.rotation.x=-Math.PI/2,this.visi3D.fun_rotationZ=function(){},this.rec=function(e){e.parent&&this.rec(e.parent)},this.rec(i.content3d),this.sceneSB=new m(this.visi3D);for(var A=0;A<this.sceneSB.array.length;A++)void 0===t.objectBase.scene[this.sceneSB.array[A].name]&&(t.objectBase.scene[this.sceneSB.array[A].name]={}),this.sceneSB.array[A].setBasa(t.objectBase.scene[this.sceneSB.array[A].name]);this.linkGrid="data:image/png;base64,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",this.grid=new B(this.whSize,this.whSize/100,this.linkGrid,.7),this.grid.position.z=5,this.visi3D.groupObject.add(this.grid),this.visi3D.objShadow(this.grid,!0),this.pm=new le(this.visi3D,t.objectBase),trace(t.objectBase),this.menu=new u(this,function(e,t){"index"==e&&(i.index=t),"index1"==e&&i.backpack.redrag1(t),i.visi3D.intRend=1}),this.backpack=new f(this,function(e,t){"index"==e&&(i.index=t),i.visi3D.intRend=1});var a=20;this.update=function(){this.visi3D.upDate(),30==++a&&(this.visi3D.intRend=1)},this.sizeWindow=function(e,t,i){this.scale=i,this.dCont.scale=i,this.visi3D.sizeWindow(0,0,e,t),this.menu.sizeWindow(e,t,i)}}var t,i,A;return t=e,(i=[{key:"index",set:function(e){this._index!=e&&(this._index=e,this.menu.index=e,this.backpack.index=e)},get:function(){return this._index}}])&&ue(t.prototype,i),A&&ue(t,A),e}()},function(e,t,i){"use strict";function A(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}var a,n,r;Object.assign(A.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),A.FullScreenQuad=(a=new THREE.OrthographicCamera(-1,1,1,-1,0,1),n=new THREE.PlaneBufferGeometry(2,2),r=function(e){this._mesh=new THREE.Mesh(n,e)},Object.defineProperty(r.prototype,"material",{get:function(){return this._mesh.material},set:function(e){this._mesh.material=e}}),Object.assign(r.prototype,{render:function(e){e.render(this._mesh,a)}}),r);var s=function(e,t){A.call(this),this.textureID=void 0!==t?t:"tDiffuse",e instanceof THREE.ShaderMaterial?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=THREE.UniformsUtils.clone(e.uniforms),this.material=new THREE.ShaderMaterial({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new A.FullScreenQuad(this.material)};s.prototype=Object.assign(Object.create(A.prototype),{constructor:s,render:function(e,t,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}});var o=function(e,t){if(this.renderer=e,void 0===t){var i={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1},A=e.getSize(new THREE.Vector2);this._pixelRatio=e.getPixelRatio(),this._width=A.width,this._height=A.height,(t=new THREE.WebGLRenderTarget(this._width*this._pixelRatio,this._height*this._pixelRatio,i)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new s(THREE.CopyShader),this.clock=new THREE.Clock};Object.assign(o.prototype,{swapBuffers:function(){var e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e},addPass:function(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)},insertPass:function(e,t){this.passes.splice(t,0,e)},isLastEnabledPass:function(e){for(var t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0},render:function(e){void 0===e&&(e=this.clock.getDelta());var t,i,A=this.renderer.getRenderTarget(),a=!1,n=this.passes.length;for(i=0;i<n;i++)if(!1!==(t=this.passes[i]).enabled){if(t.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(i),t.render(this.renderer,this.writeBuffer,this.readBuffer,e,a),t.needsSwap){if(a){var r=this.renderer.getContext(),s=this.renderer.state.buffers.stencil;s.setFunc(r.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),s.setFunc(r.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==THREE.MaskPass&&(t instanceof THREE.MaskPass?a=!0:t instanceof THREE.ClearMaskPass&&(a=!1))}this.renderer.setRenderTarget(A)},reset:function(e){if(void 0===e){var t=this.renderer.getSize(new THREE.Vector2);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(e,t){this._width=e,this._height=t;var i=this._width*this._pixelRatio,A=this._height*this._pixelRatio;this.renderTarget1.setSize(i,A),this.renderTarget2.setSize(i,A);for(var a=0;a<this.passes.length;a++)this.passes[a].setSize(i,A)},setPixelRatio:function(e){this._pixelRatio=e,this.setSize(this._width,this._height)}});var h=function(e,t,i,a,n){A.call(this),this.scene=e,this.camera=t,this.overrideMaterial=i,this.clearColor=a,this.clearAlpha=void 0!==n?n:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1};h.prototype=Object.assign(Object.create(A.prototype),{constructor:h,render:function(e,t,i){var A,a,n=e.autoClear;e.autoClear=!1,this.scene.overrideMaterial=this.overrideMaterial,this.clearColor&&(A=e.getClearColor().getHex(),a=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:i),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(A,a),this.scene.overrideMaterial=null,e.autoClear=n}});var l={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tgl_FragColor = opacity * texel;","}"].join("\n")},d=function(e,t,i,a){this.renderScene=t,this.renderCamera=i,this.selectedObjects=void 0!==a?a:[],this.visibleEdgeColor=new THREE.Color(1,1,1),this.hiddenEdgeColor=new THREE.Color(.1,.04,.02),this.edgeGlow=0,this.usePatternTexture=!1,this.edgeThickness=1,this.edgeStrength=3,this.downSampleRatio=2,this.pulsePeriod=0,A.call(this),this.resolution=void 0!==e?new THREE.Vector2(e.x,e.y):new THREE.Vector2(256,256);var n={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat},r=Math.round(this.resolution.x/this.downSampleRatio),s=Math.round(this.resolution.y/this.downSampleRatio);this.maskBufferMaterial=new THREE.MeshBasicMaterial({color:16777215}),this.maskBufferMaterial.side=THREE.DoubleSide,this.renderTargetMaskBuffer=new THREE.WebGLRenderTarget(this.resolution.x,this.resolution.y,n),this.renderTargetMaskBuffer.texture.name="OutlinePass.mask",this.renderTargetMaskBuffer.texture.generateMipmaps=!1,this.depthMaterial=new THREE.MeshDepthMaterial,this.depthMaterial.side=THREE.DoubleSide,this.depthMaterial.depthPacking=THREE.RGBADepthPacking,this.depthMaterial.blending=THREE.NoBlending,this.prepareMaskMaterial=this.getPrepareMaskMaterial(),this.prepareMaskMaterial.side=THREE.DoubleSide,this.prepareMaskMaterial.fragmentShader=function(e,t){var i=t.isPerspectiveCamera?"perspective":"orthographic";return e.replace(/DEPTH_TO_VIEW_Z/g,i+"DepthToViewZ")}(this.prepareMaskMaterial.fragmentShader,this.renderCamera),this.renderTargetDepthBuffer=new THREE.WebGLRenderTarget(this.resolution.x,this.resolution.y,n),this.renderTargetDepthBuffer.texture.name="OutlinePass.depth",this.renderTargetDepthBuffer.texture.generateMipmaps=!1,this.renderTargetMaskDownSampleBuffer=new THREE.WebGLRenderTarget(r,s,n),this.renderTargetMaskDownSampleBuffer.texture.name="OutlinePass.depthDownSample",this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps=!1,this.renderTargetBlurBuffer1=new THREE.WebGLRenderTarget(r,s,n),this.renderTargetBlurBuffer1.texture.name="OutlinePass.blur1",this.renderTargetBlurBuffer1.texture.generateMipmaps=!1,this.renderTargetBlurBuffer2=new THREE.WebGLRenderTarget(Math.round(r/2),Math.round(s/2),n),this.renderTargetBlurBuffer2.texture.name="OutlinePass.blur2",this.renderTargetBlurBuffer2.texture.generateMipmaps=!1,this.edgeDetectionMaterial=this.getEdgeDetectionMaterial(),this.renderTargetEdgeBuffer1=new THREE.WebGLRenderTarget(r,s,n),this.renderTargetEdgeBuffer1.texture.name="OutlinePass.edge1",this.renderTargetEdgeBuffer1.texture.generateMipmaps=!1,this.renderTargetEdgeBuffer2=new THREE.WebGLRenderTarget(Math.round(r/2),Math.round(s/2),n),this.renderTargetEdgeBuffer2.texture.name="OutlinePass.edge2",this.renderTargetEdgeBuffer2.texture.generateMipmaps=!1;this.separableBlurMaterial1=this.getSeperableBlurMaterial(4),this.separableBlurMaterial1.uniforms.texSize.value=new THREE.Vector2(r,s),this.separableBlurMaterial1.uniforms.kernelRadius.value=1,this.separableBlurMaterial2=this.getSeperableBlurMaterial(4),this.separableBlurMaterial2.uniforms.texSize.value=new THREE.Vector2(Math.round(r/2),Math.round(s/2)),this.separableBlurMaterial2.uniforms.kernelRadius.value=4,this.overlayMaterial=this.getOverlayMaterial(),void 0===l&&console.error("OutlinePass relies on CopyShader");var o=l;this.copyUniforms=THREE.UniformsUtils.clone(o.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new THREE.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:o.vertexShader,fragmentShader:o.fragmentShader,blending:THREE.NoBlending,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this.oldClearColor=new THREE.Color,this.oldClearAlpha=1,this.fsQuad=new A.FullScreenQuad(null),this.tempPulseColor1=new THREE.Color,this.tempPulseColor2=new THREE.Color,this.textureMatrix=new THREE.Matrix4};d.prototype=Object.assign(Object.create(A.prototype),{constructor:d,dispose:function(){this.renderTargetMaskBuffer.dispose(),this.renderTargetDepthBuffer.dispose(),this.renderTargetMaskDownSampleBuffer.dispose(),this.renderTargetBlurBuffer1.dispose(),this.renderTargetBlurBuffer2.dispose(),this.renderTargetEdgeBuffer1.dispose(),this.renderTargetEdgeBuffer2.dispose()},setSize:function(e,t){this.renderTargetMaskBuffer.setSize(e,t);var i=Math.round(e/this.downSampleRatio),A=Math.round(t/this.downSampleRatio);this.renderTargetMaskDownSampleBuffer.setSize(i,A),this.renderTargetBlurBuffer1.setSize(i,A),this.renderTargetEdgeBuffer1.setSize(i,A),this.separableBlurMaterial1.uniforms.texSize.value=new THREE.Vector2(i,A),i=Math.round(i/2),A=Math.round(A/2),this.renderTargetBlurBuffer2.setSize(i,A),this.renderTargetEdgeBuffer2.setSize(i,A),this.separableBlurMaterial2.uniforms.texSize.value=new THREE.Vector2(i,A)},changeVisibilityOfSelectedObjects:function(e){function t(t){t.isMesh&&(e?(t.visible=t.userData.oldVisible,delete t.userData.oldVisible):(t.userData.oldVisible=t.visible,t.visible=e))}for(var i=0;i<this.selectedObjects.length;i++){this.selectedObjects[i].traverse(t)}},changeVisibilityOfNonSelectedObjects:function(e){var t=[];function i(e){e.isMesh&&t.push(e)}for(var A=0;A<this.selectedObjects.length;A++){this.selectedObjects[A].traverse(i)}this.renderScene.traverse(function(i){if(i.isMesh||i.isLine||i.isSprite){for(var A=!1,a=0;a<t.length;a++)if(t[a].id===i.id){A=!0;break}if(!A){var n=i.visible;e&&!i.bVisible||(i.visible=e),i.bVisible=n}}})},updateTextureMatrix:function(){this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.renderCamera.projectionMatrix),this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse)},render:function(e,t,i,A,a){if(this.selectedObjects.length>0){this.oldClearColor.copy(e.getClearColor()),this.oldClearAlpha=e.getClearAlpha();var n=e.autoClear;e.autoClear=!1,a&&e.state.buffers.stencil.setTest(!1),e.setClearColor(16777215,1),this.changeVisibilityOfSelectedObjects(!1);var r=this.renderScene.background;if(this.renderScene.background=null,this.renderScene.overrideMaterial=this.depthMaterial,e.setRenderTarget(this.renderTargetDepthBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.changeVisibilityOfSelectedObjects(!0),this.updateTextureMatrix(),this.changeVisibilityOfNonSelectedObjects(!1),this.renderScene.overrideMaterial=this.prepareMaskMaterial,this.prepareMaskMaterial.uniforms.cameraNearFar.value=new THREE.Vector2(this.renderCamera.near,this.renderCamera.far),this.prepareMaskMaterial.uniforms.depthTexture.value=this.renderTargetDepthBuffer.texture,this.prepareMaskMaterial.uniforms.textureMatrix.value=this.textureMatrix,e.setRenderTarget(this.renderTargetMaskBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.renderScene.overrideMaterial=null,this.changeVisibilityOfNonSelectedObjects(!0),this.renderScene.background=r,this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetMaskBuffer.texture,e.setRenderTarget(this.renderTargetMaskDownSampleBuffer),e.clear(),this.fsQuad.render(e),this.tempPulseColor1.copy(this.visibleEdgeColor),this.tempPulseColor2.copy(this.hiddenEdgeColor),this.pulsePeriod>0){var s=.625+.75*Math.cos(.01*performance.now()/this.pulsePeriod)/2;this.tempPulseColor1.multiplyScalar(s),this.tempPulseColor2.multiplyScalar(s)}this.fsQuad.material=this.edgeDetectionMaterial,this.edgeDetectionMaterial.uniforms.maskTexture.value=this.renderTargetMaskDownSampleBuffer.texture,this.edgeDetectionMaterial.uniforms.texSize.value=new THREE.Vector2(this.renderTargetMaskDownSampleBuffer.width,this.renderTargetMaskDownSampleBuffer.height),this.edgeDetectionMaterial.uniforms.visibleEdgeColor.value=this.tempPulseColor1,this.edgeDetectionMaterial.uniforms.hiddenEdgeColor.value=this.tempPulseColor2,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial1,this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=d.BlurDirectionX,this.separableBlurMaterial1.uniforms.kernelRadius.value=this.edgeThickness,e.setRenderTarget(this.renderTargetBlurBuffer1),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetBlurBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=d.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial2,this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial2.uniforms.direction.value=d.BlurDirectionX,e.setRenderTarget(this.renderTargetBlurBuffer2),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetBlurBuffer2.texture,this.separableBlurMaterial2.uniforms.direction.value=d.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer2),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.overlayMaterial,this.overlayMaterial.uniforms.maskTexture.value=this.renderTargetMaskBuffer.texture,this.overlayMaterial.uniforms.edgeTexture1.value=this.renderTargetEdgeBuffer1.texture,this.overlayMaterial.uniforms.edgeTexture2.value=this.renderTargetEdgeBuffer2.texture,this.overlayMaterial.uniforms.patternTexture.value=this.patternTexture,this.overlayMaterial.uniforms.edgeStrength.value=this.edgeStrength,this.overlayMaterial.uniforms.edgeGlow.value=this.edgeGlow,this.overlayMaterial.uniforms.usePatternTexture.value=this.usePatternTexture,a&&e.state.buffers.stencil.setTest(!0),e.setRenderTarget(i),this.fsQuad.render(e),e.setClearColor(this.oldClearColor,this.oldClearAlpha),e.autoClear=n}this.renderToScreen&&(this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=i.texture,e.setRenderTarget(null),this.fsQuad.render(e))},getPrepareMaskMaterial:function(){return new THREE.ShaderMaterial({uniforms:{depthTexture:{value:null},cameraNearFar:{value:new THREE.Vector2(.5,.5)},textureMatrix:{value:new THREE.Matrix4}},vertexShader:["varying vec4 projTexCoord;","varying vec4 vPosition;","uniform mat4 textureMatrix;","void main() {","\tvPosition = modelViewMatrix * vec4( position, 1.0 );","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tprojTexCoord = textureMatrix * worldPosition;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <packing>","varying vec4 vPosition;","varying vec4 projTexCoord;","uniform sampler2D depthTexture;","uniform vec2 cameraNearFar;","void main() {","\tfloat depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));","\tfloat viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );","\tfloat depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;","\tgl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);","}"].join("\n")})},getEdgeDetectionMaterial:function(){return new THREE.ShaderMaterial({uniforms:{maskTexture:{value:null},texSize:{value:new THREE.Vector2(.5,.5)},visibleEdgeColor:{value:new THREE.Vector3(1,1,1)},hiddenEdgeColor:{value:new THREE.Vector3(1,1,1)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D maskTexture;\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec3 visibleEdgeColor;\t\t\t\tuniform vec3 hiddenEdgeColor;\t\t\t\t\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tvec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);\t\t\t\t\tvec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);\t\t\t\t\tvec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);\t\t\t\t\tvec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);\t\t\t\t\tvec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);\t\t\t\t\tfloat diff1 = (c1.r - c2.r)*0.5;\t\t\t\t\tfloat diff2 = (c3.r - c4.r)*0.5;\t\t\t\t\tfloat d = length( vec2(diff1, diff2) );\t\t\t\t\tfloat a1 = min(c1.g, c2.g);\t\t\t\t\tfloat a2 = min(c3.g, c4.g);\t\t\t\t\tfloat visibilityFactor = min(a1, a2);\t\t\t\t\tvec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;\t\t\t\t\tgl_FragColor = vec4(edgeColor, 1.0) * vec4(d);\t\t\t\t}"})},getSeperableBlurMaterial:function(e){return new THREE.ShaderMaterial({defines:{MAX_RADIUS:e},uniforms:{colorTexture:{value:null},texSize:{value:new THREE.Vector2(.5,.5)},direction:{value:new THREE.Vector2(.5,.5)},kernelRadius:{value:1}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\t\t\t\tvarying vec2 vUv;\t\t\t\tuniform sampler2D colorTexture;\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec2 direction;\t\t\t\tuniform float kernelRadius;\t\t\t\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\t\t\t\t}\t\t\t\tvoid main() {\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, kernelRadius);\t\t\t\t\tvec4 diffuseSum = texture2D( colorTexture, vUv) * weightSum;\t\t\t\t\tvec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);\t\t\t\t\tvec2 uvOffset = delta;\t\t\t\t\tfor( int i = 1; i <= MAX_RADIUS; i ++ ) {\t\t\t\t\t\tfloat w = gaussianPdf(uvOffset.x, kernelRadius);\t\t\t\t\t\tvec4 sample1 = texture2D( colorTexture, vUv + uvOffset);\t\t\t\t\t\tvec4 sample2 = texture2D( colorTexture, vUv - uvOffset);\t\t\t\t\t\tdiffuseSum += ((sample1 + sample2) * w);\t\t\t\t\t\tweightSum += (2.0 * w);\t\t\t\t\t\tuvOffset += delta;\t\t\t\t\t}\t\t\t\t\tgl_FragColor = diffuseSum/weightSum;\t\t\t\t}"})},getOverlayMaterial:function(){return new THREE.ShaderMaterial({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D maskTexture;\t\t\t\tuniform sampler2D edgeTexture1;\t\t\t\tuniform sampler2D edgeTexture2;\t\t\t\tuniform sampler2D patternTexture;\t\t\t\tuniform float edgeStrength;\t\t\t\tuniform float edgeGlow;\t\t\t\tuniform bool usePatternTexture;\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tvec4 edgeValue1 = texture2D(edgeTexture1, vUv);\t\t\t\t\tvec4 edgeValue2 = texture2D(edgeTexture2, vUv);\t\t\t\t\tvec4 maskColor = texture2D(maskTexture, vUv);\t\t\t\t\tvec4 patternColor = texture2D(patternTexture, 6.0 * vUv);\t\t\t\t\tfloat visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;\t\t\t\t\tvec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;\t\t\t\t\tvec4 finalColor = edgeStrength * maskColor.r * edgeValue;\t\t\t\t\tif(usePatternTexture)\t\t\t\t\t\tfinalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);\t\t\t\t\tgl_FragColor = finalColor;\t\t\t\t}",blending:THREE.AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0})}}),d.BlurDirectionX=new THREE.Vector2(1,0),d.BlurDirectionY=new THREE.Vector2(0,1);var u={uniforms:{tDiffuse:{value:null},resolution:{value:new THREE.Vector2(1/1024,1/512)}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","","uniform sampler2D tDiffuse;","","uniform vec2 resolution;","","varying vec2 vUv;","","// FXAA 3.11 implementation by NVIDIA, ported to WebGL by Agost Biro (biro@archilogic.com)","","//----------------------------------------------------------------------------------","// File:        es3-keplerFXAAassetsshaders/FXAA_DefaultES.frag","// SDK Version: v3.00","// Email:       gameworks@nvidia.com","// Site:        http://developer.nvidia.com/","//","// Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.","//","// Redistribution and use in source and binary forms, with or without","// modification, are permitted provided that the following conditions","// are met:","//  * Redistributions of source code must retain the above copyright","//    notice, this list of conditions and the following disclaimer.","//  * Redistributions in binary form must reproduce the above copyright","//    notice, this list of conditions and the following disclaimer in the","//    documentation and/or other materials provided with the distribution.","//  * Neither the name of NVIDIA CORPORATION nor the names of its","//    contributors may be used to endorse or promote products derived","//    from this software without specific prior written permission.","//","// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY","// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE","// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR","// PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR","// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,","// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,","// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR","// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY","// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT","// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE","// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.","//","//----------------------------------------------------------------------------------","","#define FXAA_PC 1","#define FXAA_GLSL_100 1","#define FXAA_QUALITY_PRESET 12","","#define FXAA_GREEN_AS_LUMA 1","","/*--------------------------------------------------------------------------*/","#ifndef FXAA_PC_CONSOLE","    //","    // The console algorithm for PC is included","    // for developers targeting really low spec machines.","    // Likely better to just run FXAA_PC, and use a really low preset.","    //","    #define FXAA_PC_CONSOLE 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_120","    #define FXAA_GLSL_120 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_130","    #define FXAA_GLSL_130 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_3","    #define FXAA_HLSL_3 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_4","    #define FXAA_HLSL_4 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_5","    #define FXAA_HLSL_5 0","#endif","/*==========================================================================*/","#ifndef FXAA_GREEN_AS_LUMA","    //","    // For those using non-linear color,","    // and either not able to get luma in alpha, or not wanting to,","    // this enables FXAA to run using green as a proxy for luma.","    // So with this enabled, no need to pack luma in alpha.","    //","    // This will turn off AA on anything which lacks some amount of green.","    // Pure red and blue or combination of only R and B, will get no AA.","    //","    // Might want to lower the settings for both,","    //    fxaaConsoleEdgeThresholdMin","    //    fxaaQualityEdgeThresholdMin","    // In order to insure AA does not get turned off on colors","    // which contain a minor amount of green.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_GREEN_AS_LUMA 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_EARLY_EXIT","    //","    // Controls algorithm's early exit path.","    // On PS3 turning this ON adds 2 cycles to the shader.","    // On 360 turning this OFF adds 10ths of a millisecond to the shader.","    // Turning this off on console will result in a more blurry image.","    // So this defaults to on.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_EARLY_EXIT 1","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_DISCARD","    //","    // Only valid for PC OpenGL currently.","    // Probably will not work when FXAA_GREEN_AS_LUMA = 1.","    //","    // 1 = Use discard on pixels which don't need AA.","    //     For APIs which enable concurrent TEX+ROP from same surface.","    // 0 = Return unchanged color on pixels which don't need AA.","    //","    #define FXAA_DISCARD 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_FAST_PIXEL_OFFSET","    //","    // Used for GLSL 120 only.","    //","    // 1 = GL API supports fast pixel offsets","    // 0 = do not use fast pixel offsets","    //","    #ifdef GL_EXT_gpu_shader4","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifndef FXAA_FAST_PIXEL_OFFSET","        #define FXAA_FAST_PIXEL_OFFSET 0","    #endif","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GATHER4_ALPHA","    //","    // 1 = API supports gather4 on alpha channel.","    // 0 = API does not support gather4 on alpha channel.","    //","    #if (FXAA_HLSL_5 == 1)","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifndef FXAA_GATHER4_ALPHA","        #define FXAA_GATHER4_ALPHA 0","    #endif","#endif","","","/*============================================================================","                        FXAA QUALITY - TUNING KNOBS","------------------------------------------------------------------------------","NOTE the other tuning knobs are now in the shader function inputs!","============================================================================*/","#ifndef FXAA_QUALITY_PRESET","    //","    // Choose the quality preset.","    // This needs to be compiled into the shader as it effects code.","    // Best option to include multiple presets is to","    // in each shader define the preset, then include this file.","    //","    // OPTIONS","    // -----------------------------------------------------------------------","    // 10 to 15 - default medium dither (10=fastest, 15=highest quality)","    // 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)","    // 39       - no dither, very expensive","    //","    // NOTES","    // -----------------------------------------------------------------------","    // 12 = slightly faster then FXAA 3.9 and higher edge quality (default)","    // 13 = about same speed as FXAA 3.9 and better than 12","    // 23 = closest to FXAA 3.9 visually and performance wise","    //  _ = the lowest digit is directly related to performance","    // _  = the highest digit is directly related to style","    //","    #define FXAA_QUALITY_PRESET 12","#endif","","","/*============================================================================","","                           FXAA QUALITY - PRESETS","","============================================================================*/","","/*============================================================================","                     FXAA QUALITY - MEDIUM DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 10)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 3.0","    #define FXAA_QUALITY_P2 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 11)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 3.0","    #define FXAA_QUALITY_P3 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 12)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 4.0","    #define FXAA_QUALITY_P4 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 13)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 4.0","    #define FXAA_QUALITY_P5 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 14)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 4.0","    #define FXAA_QUALITY_P6 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 15)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 12.0","#endif","","/*============================================================================","                     FXAA QUALITY - LOW DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 20)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 2.0","    #define FXAA_QUALITY_P2 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 21)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 22)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 23)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 24)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 3.0","    #define FXAA_QUALITY_P6 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 25)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 26)","    #define FXAA_QUALITY_PS 9","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 4.0","    #define FXAA_QUALITY_P8 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 27)","    #define FXAA_QUALITY_PS 10","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 4.0","    #define FXAA_QUALITY_P9 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 28)","    #define FXAA_QUALITY_PS 11","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 4.0","    #define FXAA_QUALITY_P10 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 29)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","/*============================================================================","                     FXAA QUALITY - EXTREME QUALITY","============================================================================*/","#if (FXAA_QUALITY_PRESET == 39)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.0","    #define FXAA_QUALITY_P2 1.0","    #define FXAA_QUALITY_P3 1.0","    #define FXAA_QUALITY_P4 1.0","    #define FXAA_QUALITY_P5 1.5","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","","","/*============================================================================","","                                API PORTING","","============================================================================*/","#if (FXAA_GLSL_100 == 1) || (FXAA_GLSL_120 == 1) || (FXAA_GLSL_130 == 1)","    #define FxaaBool bool","    #define FxaaDiscard discard","    #define FxaaFloat float","    #define FxaaFloat2 vec2","    #define FxaaFloat3 vec3","    #define FxaaFloat4 vec4","    #define FxaaHalf float","    #define FxaaHalf2 vec2","    #define FxaaHalf3 vec3","    #define FxaaHalf4 vec4","    #define FxaaInt2 ivec2","    #define FxaaSat(x) clamp(x, 0.0, 1.0)","    #define FxaaTex sampler2D","#else","    #define FxaaBool bool","    #define FxaaDiscard clip(-1)","    #define FxaaFloat float","    #define FxaaFloat2 float2","    #define FxaaFloat3 float3","    #define FxaaFloat4 float4","    #define FxaaHalf half","    #define FxaaHalf2 half2","    #define FxaaHalf3 half3","    #define FxaaHalf4 half4","    #define FxaaSat(x) saturate(x)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_100 == 1)","  #define FxaaTexTop(t, p) texture2D(t, p, 0.0)","  #define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), 0.0)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_120 == 1)","    // Requires,","    //  #version 120","    // And at least,","    //  #extension GL_EXT_gpu_shader4 : enable","    //  (or set FXAA_FAST_PIXEL_OFFSET 1 to work like DX9)","    #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)","    #if (FXAA_FAST_PIXEL_OFFSET == 1)","        #define FxaaTexOff(t, p, o, r) texture2DLodOffset(t, p, 0.0, o)","    #else","        #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)","    #endif","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_130 == 1)",'    // Requires "#version 130" or better',"    #define FxaaTexTop(t, p) textureLod(t, p, 0.0)","    #define FxaaTexOff(t, p, o, r) textureLodOffset(t, p, 0.0, o)","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_3 == 1)","    #define FxaaInt2 float2","    #define FxaaTex sampler2D","    #define FxaaTexTop(t, p) tex2Dlod(t, float4(p, 0.0, 0.0))","    #define FxaaTexOff(t, p, o, r) tex2Dlod(t, float4(p + (o * r), 0, 0))","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_4 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_5 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","    #define FxaaTexAlpha4(t, p) t.tex.GatherAlpha(t.smpl, p)","    #define FxaaTexOffAlpha4(t, p, o) t.tex.GatherAlpha(t.smpl, p, o)","    #define FxaaTexGreen4(t, p) t.tex.GatherGreen(t.smpl, p)","    #define FxaaTexOffGreen4(t, p, o) t.tex.GatherGreen(t.smpl, p, o)","#endif","","","/*============================================================================","                   GREEN AS LUMA OPTION SUPPORT FUNCTION","============================================================================*/","#if (FXAA_GREEN_AS_LUMA == 0)","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.w; }","#else","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }","#endif","","","","","/*============================================================================","","                             FXAA3 QUALITY - PC","","============================================================================*/","#if (FXAA_PC == 1)","/*--------------------------------------------------------------------------*/","FxaaFloat4 FxaaPixelShader(","    //","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy} = center of pixel","    FxaaFloat2 pos,","    //","    // Used only for FXAA Console, and not used on the 360 version.","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy_} = upper left of pixel","    // {_zw} = lower right of pixel","    FxaaFloat4 fxaaConsolePosPos,","    //","    // Input color texture.","    // {rgb_} = color in linear or perceptual color space","    // if (FXAA_GREEN_AS_LUMA == 0)","    //     {__a} = luma in perceptual color space (not linear)","    FxaaTex tex,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 2nd sampler.","    // This sampler needs to have an exponent bias of -1.","    FxaaTex fxaaConsole360TexExpBiasNegOne,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 3nd sampler.","    // This sampler needs to have an exponent bias of -2.","    FxaaTex fxaaConsole360TexExpBiasNegTwo,","    //","    // Only used on FXAA Quality.","    // This must be from a constant/uniform.","    // {x_} = 1.0/screenWidthInPixels","    // {_y} = 1.0/screenHeightInPixels","    FxaaFloat2 fxaaQualityRcpFrame,","    //","    // Only used on FXAA Console.","    // This must be from a constant/uniform.","    // This effects sub-pixel AA quality and inversely sharpness.","    //   Where N ranges between,","    //     N = 0.50 (default)","    //     N = 0.33 (sharper)","    // {x__} = -N/screenWidthInPixels","    // {_y_} = -N/screenHeightInPixels","    // {_z_} =  N/screenWidthInPixels","    // {__w} =  N/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt,","    //","    // Only used on FXAA Console.","    // Not used on 360, but used on PS3 and PC.","    // This must be from a constant/uniform.","    // {x__} = -2.0/screenWidthInPixels","    // {_y_} = -2.0/screenHeightInPixels","    // {_z_} =  2.0/screenWidthInPixels","    // {__w} =  2.0/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt2,","    //","    // Only used on FXAA Console.","    // Only used on 360 in place of fxaaConsoleRcpFrameOpt2.","    // This must be from a constant/uniform.","    // {x__} =  8.0/screenWidthInPixels","    // {_y_} =  8.0/screenHeightInPixels","    // {_z_} = -4.0/screenWidthInPixels","    // {__w} = -4.0/screenHeightInPixels","    FxaaFloat4 fxaaConsole360RcpFrameOpt2,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_SUBPIX define.","    // It is here now to allow easier tuning.","    // Choose the amount of sub-pixel aliasing removal.","    // This can effect sharpness.","    //   1.00 - upper limit (softer)","    //   0.75 - default amount of filtering","    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)","    //   0.25 - almost off","    //   0.00 - completely off","    FxaaFloat fxaaQualitySubpix,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // The minimum amount of local contrast required to apply algorithm.","    //   0.333 - too little (faster)","    //   0.250 - low quality","    //   0.166 - default","    //   0.125 - high quality","    //   0.063 - overkill (slower)","    FxaaFloat fxaaQualityEdgeThreshold,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    //   0.0833 - upper limit (default, the start of visible unfiltered edges)","    //   0.0625 - high quality (faster)","    //   0.0312 - visible limit (slower)","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaQualityEdgeThresholdMin,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_SHARPNESS define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_SHARPNESS for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only three safe values here: 2 and 4 and 8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // For all other platforms can be a non-power of two.","    //   8.0 is sharper (default!!!)","    //   4.0 is softer","    //   2.0 is really soft (good only for vector graphics inputs)","    FxaaFloat fxaaConsoleEdgeSharpness,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_THRESHOLD for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only two safe values here: 1/4 and 1/8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // The console setting has a different mapping than the quality setting.","    // Other platforms can use other values.","    //   0.125 leaves less aliasing, but is softer (default!!!)","    //   0.25 leaves more aliasing, and is sharper","    FxaaFloat fxaaConsoleEdgeThreshold,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    // The console setting has a different mapping than the quality setting.","    // This only applies when FXAA_EARLY_EXIT is 1.","    // This does not apply to PS3,","    // PS3 was simplified to avoid more shader instructions.","    //   0.06 - faster but more aliasing in darks","    //   0.05 - default","    //   0.04 - slower and less aliasing in darks","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaConsoleEdgeThresholdMin,","    //","    // Extra constants for 360 FXAA Console only.","    // Use zeros or anything else for other platforms.","    // These must be in physical constant registers and NOT immediates.","    // Immediates will result in compiler un-optimizing.","    // {xyzw} = float4(1.0, -1.0, 0.25, -0.25)","    FxaaFloat4 fxaaConsole360ConstDir",") {","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posM;","    posM.x = pos.x;","    posM.y = pos.y;","    #if (FXAA_GATHER4_ALPHA == 1)","        #if (FXAA_DISCARD == 0)","            FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","            #if (FXAA_GREEN_AS_LUMA == 0)","                #define lumaM rgbyM.w","            #else","                #define lumaM rgbyM.y","            #endif","        #endif","        #if (FXAA_GREEN_AS_LUMA == 0)","            FxaaFloat4 luma4A = FxaaTexAlpha4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffAlpha4(tex, posM, FxaaInt2(-1, -1));","        #else","            FxaaFloat4 luma4A = FxaaTexGreen4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffGreen4(tex, posM, FxaaInt2(-1, -1));","        #endif","        #if (FXAA_DISCARD == 1)","            #define lumaM luma4A.w","        #endif","        #define lumaE luma4A.z","        #define lumaS luma4A.x","        #define lumaSE luma4A.y","        #define lumaNW luma4B.w","        #define lumaN luma4B.z","        #define lumaW luma4B.x","    #else","        FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","        #if (FXAA_GREEN_AS_LUMA == 0)","            #define lumaM rgbyM.w","        #else","            #define lumaM rgbyM.y","        #endif","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 0.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 0.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));","        #endif","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat maxSM = max(lumaS, lumaM);","    FxaaFloat minSM = min(lumaS, lumaM);","    FxaaFloat maxESM = max(lumaE, maxSM);","    FxaaFloat minESM = min(lumaE, minSM);","    FxaaFloat maxWN = max(lumaN, lumaW);","    FxaaFloat minWN = min(lumaN, lumaW);","    FxaaFloat rangeMax = max(maxWN, maxESM);","    FxaaFloat rangeMin = min(minWN, minESM);","    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;","    FxaaFloat range = rangeMax - rangeMin;","    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);","    FxaaBool earlyExit = range < rangeMaxClamped;","/*--------------------------------------------------------------------------*/","    if(earlyExit)","        #if (FXAA_DISCARD == 1)","            FxaaDiscard;","        #else","            return rgbyM;","        #endif","/*--------------------------------------------------------------------------*/","    #if (FXAA_GATHER4_ALPHA == 0)","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 1.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","        #endif","    #else","        FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(1, -1), fxaaQualityRcpFrame.xy));","        FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNS = lumaN + lumaS;","    FxaaFloat lumaWE = lumaW + lumaE;","    FxaaFloat subpixRcpRange = 1.0/range;","    FxaaFloat subpixNSWE = lumaNS + lumaWE;","    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;","    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNESE = lumaNE + lumaSE;","    FxaaFloat lumaNWNE = lumaNW + lumaNE;","    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;","    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNWSW = lumaNW + lumaSW;","    FxaaFloat lumaSWSE = lumaSW + lumaSE;","    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);","    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);","    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;","    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;","    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;","    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;","/*--------------------------------------------------------------------------*/","    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;","    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;","    FxaaBool horzSpan = edgeHorz >= edgeVert;","    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;","/*--------------------------------------------------------------------------*/","    if(!horzSpan) lumaN = lumaW;","    if(!horzSpan) lumaS = lumaE;","    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;","    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;","/*--------------------------------------------------------------------------*/","    FxaaFloat gradientN = lumaN - lumaM;","    FxaaFloat gradientS = lumaS - lumaM;","    FxaaFloat lumaNN = lumaN + lumaM;","    FxaaFloat lumaSS = lumaS + lumaM;","    FxaaBool pairN = abs(gradientN) >= abs(gradientS);","    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));","    if(pairN) lengthSign = -lengthSign;","    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posB;","    posB.x = posM.x;","    posB.y = posM.y;","    FxaaFloat2 offNP;","    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;","    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;","    if(!horzSpan) posB.x += lengthSign * 0.5;","    if( horzSpan) posB.y += lengthSign * 0.5;","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posN;","    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;","    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;","    FxaaFloat2 posP;","    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;","    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;","    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;","    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));","    FxaaFloat subpixE = subpixC * subpixC;","    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));","/*--------------------------------------------------------------------------*/","    if(!pairN) lumaNN = lumaSS;","    FxaaFloat gradientScaled = gradient * 1.0/4.0;","    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;","    FxaaFloat subpixF = subpixD * subpixE;","    FxaaBool lumaMLTZero = lumaMM < 0.0;","/*--------------------------------------------------------------------------*/","    lumaEndN -= lumaNN * 0.5;","    lumaEndP -= lumaNN * 0.5;","    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;","    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;","    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;","    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;","    FxaaBool doneNP = (!doneN) || (!doneP);","    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;","    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;","/*--------------------------------------------------------------------------*/","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 3)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 4)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 5)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 6)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;","/*--------------------------------------------------------------------------*/","                        #if (FXAA_QUALITY_PS > 7)","                        if(doneNP) {","                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                            doneN = abs(lumaEndN) >= gradientScaled;","                            doneP = abs(lumaEndP) >= gradientScaled;","                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;","                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;","                            doneNP = (!doneN) || (!doneP);","                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;","                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;","/*--------------------------------------------------------------------------*/","    #if (FXAA_QUALITY_PS > 8)","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 9)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 10)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 11)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 12)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","    #endif","/*--------------------------------------------------------------------------*/","                        }","                        #endif","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","/*--------------------------------------------------------------------------*/","    FxaaFloat dstN = posM.x - posN.x;","    FxaaFloat dstP = posP.x - posM.x;","    if(!horzSpan) dstN = posM.y - posN.y;","    if(!horzSpan) dstP = posP.y - posM.y;","/*--------------------------------------------------------------------------*/","    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;","    FxaaFloat spanLength = (dstP + dstN);","    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;","    FxaaFloat spanLengthRcp = 1.0/spanLength;","/*--------------------------------------------------------------------------*/","    FxaaBool directionN = dstN < dstP;","    FxaaFloat dst = min(dstN, dstP);","    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;","    FxaaFloat subpixG = subpixF * subpixF;","    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;","    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;","/*--------------------------------------------------------------------------*/","    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;","    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);","    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;","    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;","    #if (FXAA_DISCARD == 1)","        return FxaaTexTop(tex, posM);","    #else","        return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);","    #endif","}","/*==========================================================================*/","#endif","","void main() {","  gl_FragColor = FxaaPixelShader(","    vUv,","    vec4(0.0),","    tDiffuse,","    tDiffuse,","    tDiffuse,","    resolution,","    vec4(0.0),","    vec4(0.0),","    vec4(0.0),","    0.75,","    0.166,","    0.0833,","    0.0,","    0.0,","    0.0,","    vec4(0.0)","  );","","  // TODO avoid querying texture twice for same texel","  gl_FragColor.a = texture2D(tDiffuse, vUv).a;","}"].join("\n")};function c(e,t){for(var i=0;i<t.length;i++){var A=t[i];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(e,A.key,A)}}i.d(t,"a",function(){return f});var f=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._width=100,this._height=100,this.visi3D=t,this._active=!1,this._edgeStrength=3,this._edgeGlow=0,this._edgeThickness=1,this._pulsePeriod=0,this._visibleEdgeColor="#ffffff",this._hiddenEdgeColor="#190a05",this._boolTextur=!1,this._linkTextur="null";var A=new o(t.renderer),a=new h(t.scene,t.camera);A.addPass(a);var n=new d(new THREE.Vector2(window.innerWidth,window.innerHeight),t.scene,t.camera);A.addPass(n),this.outlinePass=n;var r=new s(u);r.uniforms.resolution.value.set(1/window.innerWidth,1/window.innerHeight),A.addPass(r),this.outlinePass.edgeStrength=this._edgeStrength,this.outlinePass.edgeGlow=this._edgeGlow,this.outlinePass.edgeThickness=this._edgeThickness,this.outlinePass.pulsePeriod=this._pulsePeriod,this.outlinePass.visibleEdgeColor.set(this._visibleEdgeColor),this.outlinePass.hiddenEdgeColor.set(this._hiddenEdgeColor),this._visibleEdgeColor="#ffffff",this._hiddenEdgeColor="#190a05",this.dragLink=function(){(new THREE.TextureLoader).load(this._linkTextur,function(e){n.patternTexture=e,e.wrapS=THREE.RepeatWrapping,e.wrapT=THREE.RepeatWrapping,t.intRend=1})},this.sizeWindow=function(e,t){this._width=e,this._height=t,r.uniforms.resolution.value.set(1/e,1/t),A.setSize(e,t)},this.render=function(){return 0==this._active?this._active:(A.render(),!0)},this.setValue=function(e){1!=Array.isArray(e)?n.selectedObjects=null!=e||null!=e?[e]:[]:n.selectedObjects=e}}var t,i,A;return t=e,(i=[{key:"active",set:function(e){this._active!=e&&(this._active=e,this.visi3D.intRend=1)},get:function(){return this._active}},{key:"edgeStrength",set:function(e){this._edgeStrength!=e&&(this._edgeStrength=e,this.outlinePass.edgeStrength=this._edgeStrength)},get:function(){return this._edgeStrength}},{key:"edgeGlow",set:function(e){this._edgeGlow!=e&&(this._edgeGlow=e,this.outlinePass.edgeGlow=this._edgeGlow)},get:function(){return this._edgeGlow}},{key:"pulsePeriod",set:function(e){this._pulsePeriod!=e&&(this._pulsePeriod=e,this.outlinePass.pulsePeriod=this._pulsePeriod)},get:function(){return this._pulsePeriod}},{key:"linkTextur",set:function(e){this._linkTextur!=e&&(this._linkTextur=e,"null"==this._linkTextur?this.outlinePass.usePatternTexture=!1:(this.outlinePass.usePatternTexture=!0,this.dragLink()))},get:function(){return this._linkTextur}},{key:"visibleEdgeColor",set:function(e){this._visibleEdgeColor!=e&&(this._visibleEdgeColor=e,this.outlinePass.visibleEdgeColor.set(this._visibleEdgeColor))},get:function(){return this._visibleEdgeColor}},{key:"hiddenEdgeColor",set:function(e){this._hiddenEdgeColor!=e&&(this._hiddenEdgeColor=e,this.outlinePass.hiddenEdgeColor.set(this._hiddenEdgeColor))},get:function(){return this._hiddenEdgeColor}}])&&c(t.prototype,i),A&&c(t,A),e}()},function(e,t,i){"use strict";function A(){this.event=void 0,this.arrSobName=["up","down","move","out","over","wheel"],this.arrSob=[[],[],[],[],[],[]],this.pozSob=void 0,this.dispatcherEvent=function(e,t){for(var i=0;i<this.arrSobName.length;i++)if(this.arrSobName[i]==e){t&&(t.type=e);for(var A=0;A<this.arrSob[i].length;A++)this.arrSob[i][A](t)}},this.removeEvent=function(e,t){for(var i=0;i<this.arrSobName.length;i++)if(this.arrSobName[i]==e)for(var A=0;A<this.arrSob[i].length;A++)this.arrSob[i][A]==t&&this.arrSob[i].splice(A,1)},this.addEvent=function(e,t){for(var i=0;i<this.arrSobName.length;i++)this.arrSobName[i]==e&&this.arrSob[i].push(t)}}function a(){this.target=void 0,this.face=void 0,this.point=void 0,this.faceIndex=void 0,this.type=void 0,this.uv=void 0,this.originalEvent=void 0,this.copy=function(){var e=new a;return e.target=this.target,e.face=this.face,e.point=this.point,e.faceIndex=this.faceIndex,e.type=this.type,e.uv=this.uv,e.originalEvent=this.originalEvent,e}}function n(e,t,i,n){this.parent=e;var r,s,o=this;this.camera=t,this.raycaster=new THREE.Raycaster,this.intersects,this.devas=e.devas,this.point=new THREE.Vector2(0,0),this.pointWH=new THREE.Vector2(0,0),this.arrChild=[],this.uuid="nullMy",this.obj3d,this.eventSob=new A,this.event3D=new a,this.xzNull="xzNull",this.poiskName="xzPoisk",this.tokoName="null",this._activ=!0,this.rect={x:0,y:0,width:100,height:100},this.cont=void 0,this.div=void 0,this.setRect=function(e,t,i,A){this.rect.x=e,this.rect.y=t,this.rect.width=i,this.rect.height=A},this.removeChild=function(e){r=null;for(var t=0;t<this.arrChild.length;t++)e.uuid==this.arrChild[t].uuid&&(r=this.arrChild.splice(t,1),(t-=1)<0&&(t=0));return r},this.addChild=function(e){this.removeChild(e),this.arrChild.push(e)},this.boolNum=-1,this.boolNumOld=-1,this.event,this.mouseRay=function(){0!=this._activ&&(this.rayPusk(),this.boolNum=this.getGoodParam(),-1==this.boolNum?"nullMy"!=this.uuid&&(this.eventSob.dispatcherEvent("out",this.event3D),this.uuid="nullMy"):"nullMy"!=this.uuid?this.uuid!=this.intersects[this.boolNum].object.uuid?(this.eventSob.dispatcherEvent("out",this.event3D),this.uuid=this.intersects[this.boolNum].object.uuid,this.event3D.target=this.intersects[this.boolNum].object,this.event3D.face=this.intersects[this.boolNum].face,this.event3D.point=this.intersects[this.boolNum].point,this.event3D.faceIndex=this.intersects[this.boolNum].faceIndex,this.event3D.uv=this.intersects[this.boolNum].uv,this.event3D.originalEvent=o.event,this.eventSob.dispatcherEvent("over",this.event3D)):(this.event3D.face=this.intersects[this.boolNum].face,this.event3D.point=this.intersects[this.boolNum].point,this.event3D.faceIndex=this.intersects[this.boolNum].faceIndex,this.event3D.uv=this.intersects[this.boolNum].uv,this.event3D.originalEvent=o.event,this.eventSob.dispatcherEvent("move",this.event3D)):(this.uuid=this.intersects[this.boolNum].object.uuid,this.event3D.target=this.intersects[this.boolNum].object,this.event3D.face=this.intersects[this.boolNum].face,this.event3D.point=this.intersects[this.boolNum].point,this.event3D.faceIndex=this.intersects[this.boolNum].faceIndex,this.event3D.uv=this.intersects[this.boolNum].uv,this.event3D.originalEvent=o.event,this.eventSob.dispatcherEvent("over",this.event3D)),this.boolNumOld=this.boolNum)},this.getPosition=function(e){var t=this.poiskName;if(this.poiskName=null!=e?e:"xzPoisk",this.restartPoint(),this.rayPusk(),this.poiskName=t,0!=this.intersects.length){var i=this.intersects.length-1;return-1==i&&(i=0),this.intersects[i]}return null};var h=new a;this.getNameEvent=function(e){if(this.restartPoint(),this.rayPusk(),0!=this.intersects.length)for(var t=0;t<this.intersects.length;t++)if(null!=this.intersects[t].object.parent&&this.intersects[t].object.name==e)return h.target=this.intersects[this.boolNum].object,h.face=this.intersects[this.boolNum].face,h.point=this.intersects[this.boolNum].point,h.faceIndex=this.intersects[this.boolNum].faceIndex,h.uv=this.intersects[this.boolNum].uv,h.originalEvent=o.event,h;return null},this.testVisiParam=function(e){return 0!=e.visible&&(!e.notEvent&&(null!=e.parent?this.testVisiParam(e.parent):"Scene"==e.type))},this.getGoodParam=function(){if(0!=this.intersects.length){var e;for(e=0;e<this.intersects.length;e++)0!=this.testVisiParam(this.intersects[e].object)&&null!=this.intersects[e].object.notActiv&&(this.intersects.splice(e,1),e=0);if(0==this.intersects.length)return-1;for(e=0;e<this.intersects.length;e++)if(0!=this.testVisiParam(this.intersects[e].object)&&this.intersects[e].object.name==this.poiskName)return e;for(e=0;e<this.intersects.length;e++)if(0!=this.testVisiParam(this.intersects[e].object)&&this.intersects[e].object.name!=this.xzNull)return e}return-1},this.rayPusk=function(){(s=new THREE.Vector3).setFromMatrixPosition(this.camera.matrixWorld),this.raycaster.ray.origin.copy(s),this.raycaster.ray.direction.set(this.point.x,this.point.y,.5).unproject(this.camera).sub(s).normalize(),this.intersects=this.raycaster.intersectObjects(this.arrChild,!0)},this.naCont=!1,this.mousemove=function(e){0==o.devas&&0==o.naCont||(null!=e.data?o.event=e.data.originalEvent:o.event=e,0!=o._activ&&(o.restartPoint(e),o.mouseRay(),o.intersects.length&&0==o.devas&&o.event.preventDefault()))},this.zdvigX=0,this.scale=1,this.pV=new THREE.Vector2(0,0),this.restartPoint=function(e){0==o.devas?(o.pV.x=e.clientX,o.pV.y=e.clientY):(o.pV.x=e.touches[0].clientX,o.pV.y=e.touches[0].clientY),1==o.isRect(o.pV)?(o.point.x=-(this.rect.x-o.pV.x)/this.rect.width*2-1,o.point.y=-(-(this.rect.y-o.pV.y)/this.rect.height*2-1)):99999!=o.point.x&&(o.point.x=99999)},this.isRect=function(e){return e.x>=this.rect.x&&e.x<=this.rect.x+this.rect.width&&e.y>=this.rect.y&&e.y<=this.rect.y+this.rect.height},this.mouseup=function(e){null!=e.data?o.event=e.data.originalEvent:o.event=e,o.intersects&&0!=o._activ&&(0==o.devas?(-1==o.boolNumOld?o.eventSob.dispatcherEvent("up",null):(o.event3D.originalEvent=o.event,o.eventSob.dispatcherEvent("up",o.event3D)),o.intersects.length&&o.event.preventDefault()):(o.mouseRay(),-1==o.boolNumOld?o.eventSob.dispatcherEvent("up",null):(o.event3D.originalEvent=o.event,o.eventSob.dispatcherEvent("up",o.event3D),o.uuid="nullMy")))},this.mousedown=function(e){null!=e.data?o.event=e.data.originalEvent:o.event=e,o.restartPoint(e),0!=o._activ&&(0==o.devas?(-1==o.boolNumOld?o.eventSob.dispatcherEvent("down",null):(o.event3D.originalEvent=o.event,o.eventSob.dispatcherEvent("down",o.event3D)),o.intersects.length&&o.event.preventDefault()):(o.mouseRay(),-1==o.boolNumOld?o.eventSob.dispatcherEvent("down",null):(o.event3D.originalEvent=o.event,o.eventSob.dispatcherEvent("down",o.event3D))))},this.mouseout=function(e){o.naCont=!1,o.restartPoint(e),o.point.x=99999,o.mouseRay()},this.mouseover=function(e){o.naCont=!0,o.restartPoint(e),o.mouseRay()},this.touchend=function(e){},this.mousewheel=function(e){null!=e.data?o.event=e.data.originalEvent:o.event=e,o.restartPoint(e),0!=o._activ&&(-1==o.boolNumOld?o.eventSob.dispatcherEvent("down",null):(o.event3D.originalEvent=o.event,o.eventSob.dispatcherEvent("wheel",e)))},this.addDragEvent=function(e,t){this.cont=e,this.div=t,0==o.devas?(window.addEventListener("mouseup",o.mouseup),t.addEventListener("mousedown",o.mousedown),t.addEventListener("mouseout",o.mouseout),t.addEventListener("mouseover",o.mouseover)):(window.addEventListener("touchend",o.mouseup),t.addEventListener("touchstart",o.mousedown))},this.sizeWindow=function(e,t){this.pointWH.x=e,this.pointWH.y=t}}i.d(t,"a",function(){return n}),n.prototype={set activ(e){this._activ!=e&&(this._activ=e)},get activ(){return this._activ}}},function(e,t,i){"use strict";i.r(t),function(e){var A=i(1);i.d(t,"Main",function(){return A.a}),e.Main=A.a}.call(this,i(6))}]);